(()=>{var e={53012:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCacheExpired=void 0;t.isCacheExpired=(e=0)=>new Date>new Date(e)},38871:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionStorage=void 0;const a=r(n(3141)),o=n(53012),i=n(22452);t.ExtensionStorage=class{constructor(e){this.get=async e=>{var t;return null!==(t=(await chrome.storage[this.cacheType].get(e))[e])&&void 0!==t?t:null},this.getValid=async e=>{const t=await this.get(e);return t&&!(0,o.isCacheExpired)(t.timeToExpire)?t:null},this.set=async({key:e,value:t,timeToExpire:n,eTag:r})=>{const a={};a[e]={value:t,timeToExpire:n},r&&(a[e].eTag=r),await chrome.storage[this.cacheType].set(a)},this.delete=async e=>{await chrome.storage[this.cacheType].remove(e)},this.handleRequestUsingCache=async({uniqueKey:e,requestUrl:t,expirationInMilliseconds:n,options:r,retry:s})=>{const c=await this.get(e);if(c&&!(0,o.isCacheExpired)(c.timeToExpire))return c.value;const u=(new Date).getTime()+(n||3e5);let l={"Cache-Control":"no-cache"};(null==c?void 0:c.eTag)&&(l["If-None-Match"]=c.eTag),r&&(l={...l,...r});return await a.default.request({uniqueKey:e,requestUrl:t,options:{method:"get",headers:l}}).then((t=>this.handleResponse(e,t,c,u))).catch((async()=>!s||s.attempts<=0?{}:(await i.TimerHelper.waitDelay(s.delayInMs),this.handleRequestUsingCache({uniqueKey:e,requestUrl:t,expirationInMilliseconds:n,options:r,retry:{attempts:s.attempts-1,delayInMs:2*s.delayInMs}}))))},this.handleResponse=async(e,t,n,r)=>{var a,o,i;const s=!t||t instanceof Error,c=(null==t?void 0:t.status)>=400||(null==t?void 0:t.status)<200;if(s||c)throw new Error(`Server error: ${null!==(a=null==t?void 0:t.status)&&void 0!==a?a:500}`);const u=null!==(o=t.headers.get("ETag"))&&void 0!==o?o:void 0;if(!(!u||!(null==n?void 0:n.eTag)||u!==n.eTag))return this.set({key:e,value:null!==(i=n.value)&&void 0!==i?i:n,timeToExpire:r,eTag:u}),n.value;const l=await t.clone().json();return this.set({key:e,value:l,timeToExpire:r,eTag:u}),l},this.cacheType=e}}},22452:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimerHelper=void 0;class n{}t.TimerHelper=n,n.waitDelay=async e=>{await new Promise((t=>setTimeout((()=>t(null)),e)))}},18731:(e,t,n)=>{"use strict";t.wS=void 0;const r=n(38871);t.wS=new r.ExtensionStorage("local"),new r.ExtensionStorage("session")},3141:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=new class{constructor(){this.cache={}}request({uniqueKey:e,requestUrl:t,options:n}){return e?(e in this.cache||(this.cache[e]=fetch(t,n).then((e=>{if(e.status<200||e.status>399)throw{message:`Response status error: ${e.status}`,status:e.status};return e})).catch((e=>e)).finally((()=>{delete this.cache[e]}))),this.cache[e]):Promise.reject(new Error("Unique key not passed"))}}},83957:(e,t,n)=>{e.exports=n(68475)},58404:(e,t,n)=>{"use strict";var r=n(92952),a=n(43366),o=n(72134),i=n(81587),s=n(56648),c=n(7238),u=n(44447);e.exports=function(e){return new Promise((function(t,l){var _=e.data,d=e.headers;r.isFormData(_)&&delete d["Content-Type"];var f=new XMLHttpRequest;if(e.auth){var h=e.auth.username||"",g=e.auth.password||"";d.Authorization="Basic "+btoa(h+":"+g)}var p=i(e.baseURL,e.url);if(f.open(e.method.toUpperCase(),o(p,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,f.onreadystatechange=function(){if(f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in f?s(f.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:n,config:e,request:f};a(t,l,r),f=null}},f.onabort=function(){f&&(l(u("Request aborted",e,"ECONNABORTED",f)),f=null)},f.onerror=function(){l(u("Network Error",e,null,f)),f=null},f.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),l(u(t,e,"ECONNABORTED",f)),f=null},r.isStandardBrowserEnv()){var m=n(67048),b=(e.withCredentials||c(p))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0;b&&(d[e.xsrfHeaderName]=b)}if("setRequestHeader"in f&&r.forEach(d,(function(e,t){void 0===_&&"content-type"===t.toLowerCase()?delete d[t]:f.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(f.withCredentials=!!e.withCredentials),e.responseType)try{f.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){f&&(f.abort(),l(e),f=null)})),void 0===_&&(_=null),f.send(_)}))}},68475:(e,t,n)=>{"use strict";var r=n(92952),a=n(22096),o=n(27359),i=n(36867);function s(e){var t=new o(e),n=a(o.prototype.request,t);return r.extend(n,o.prototype,t),r.extend(n,t),n}var c=s(n(63527));c.Axios=o,c.create=function(e){return s(i(c.defaults,e))},c.Cancel=n(31972),c.CancelToken=n(97723),c.isCancel=n(9860),c.all=function(e){return Promise.all(e)},c.spread=n(82696),e.exports=c,e.exports.default=c},31972:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},97723:(e,t,n)=>{"use strict";var r=n(31972);function a(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}a.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},a.source=function(){var e;return{token:new a((function(t){e=t})),cancel:e}},e.exports=a},9860:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},27359:(e,t,n)=>{"use strict";var r=n(92952),a=n(72134),o=n(14667),i=n(39310),s=n(36867);function c(e){this.defaults=e,this.interceptors={request:new o,response:new o}}c.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=s(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[i,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},c.prototype.getUri=function(e){return e=s(this.defaults,e),a(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,n){return this.request(r.merge(n||{},{method:e,url:t}))}})),r.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,n,a){return this.request(r.merge(a||{},{method:e,url:t,data:n}))}})),e.exports=c},14667:(e,t,n)=>{"use strict";var r=n(92952);function a(){this.handlers=[]}a.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},a.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},a.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=a},81587:(e,t,n)=>{"use strict";var r=n(67261),a=n(63756);e.exports=function(e,t){return e&&!r(t)?a(e,t):t}},44447:(e,t,n)=>{"use strict";var r=n(26965);e.exports=function(e,t,n,a,o){var i=new Error(e);return r(i,t,n,a,o)}},39310:(e,t,n)=>{"use strict";var r=n(92952),a=n(72381),o=n(9860),i=n(63527);function s(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return s(e),e.headers=e.headers||{},e.data=a(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||i.adapter)(e).then((function(t){return s(e),t.data=a(t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(s(e),t&&t.response&&(t.response.data=a(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},26965:e=>{"use strict";e.exports=function(e,t,n,r,a){return e.config=t,n&&(e.code=n),e.request=r,e.response=a,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},36867:(e,t,n)=>{"use strict";var r=n(92952);e.exports=function(e,t){t=t||{};var n={},a=["url","method","params","data"],o=["headers","auth","proxy"],i=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];r.forEach(a,(function(e){void 0!==t[e]&&(n[e]=t[e])})),r.forEach(o,(function(a){r.isObject(t[a])?n[a]=r.deepMerge(e[a],t[a]):void 0!==t[a]?n[a]=t[a]:r.isObject(e[a])?n[a]=r.deepMerge(e[a]):void 0!==e[a]&&(n[a]=e[a])})),r.forEach(i,(function(r){void 0!==t[r]?n[r]=t[r]:void 0!==e[r]&&(n[r]=e[r])}));var s=a.concat(o).concat(i),c=Object.keys(t).filter((function(e){return-1===s.indexOf(e)}));return r.forEach(c,(function(r){void 0!==t[r]?n[r]=t[r]:void 0!==e[r]&&(n[r]=e[r])})),n}},43366:(e,t,n)=>{"use strict";var r=n(44447);e.exports=function(e,t,n){var a=n.config.validateStatus;!a||a(n.status)?e(n):t(r("Request failed with status code "+n.status,n.config,null,n.request,n))}},72381:(e,t,n)=>{"use strict";var r=n(92952);e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}},63527:(e,t,n)=>{"use strict";var r=n(88538),a=n(92952),o=n(8646),i={"Content-Type":"application/x-www-form-urlencoded"};function s(e,t){!a.isUndefined(e)&&a.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c,u={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==r&&"[object process]"===Object.prototype.toString.call(r))&&(c=n(58404)),c),transformRequest:[function(e,t){return o(t,"Accept"),o(t,"Content-Type"),a.isFormData(e)||a.isArrayBuffer(e)||a.isBuffer(e)||a.isStream(e)||a.isFile(e)||a.isBlob(e)?e:a.isArrayBufferView(e)?e.buffer:a.isURLSearchParams(e)?(s(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):a.isObject(e)?(s(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},a.forEach(["delete","get","head"],(function(e){u.headers[e]={}})),a.forEach(["post","put","patch"],(function(e){u.headers[e]=a.merge(i)})),e.exports=u},22096:e=>{"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},72134:(e,t,n)=>{"use strict";var r=n(92952);function a(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(r.isURLSearchParams(t))o=t.toString();else{var i=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),i.push(a(t)+"="+a(e))})))})),o=i.join("&")}if(o){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},63756:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},67048:(e,t,n)=>{"use strict";var r=n(92952);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,a,o,i){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(a)&&s.push("path="+a),r.isString(o)&&s.push("domain="+o),!0===i&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},67261:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},7238:(e,t,n)=>{"use strict";var r=n(92952);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function a(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=a(window.location.href),function(t){var n=r.isString(t)?a(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},8646:(e,t,n)=>{"use strict";var r=n(92952);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},56648:(e,t,n)=>{"use strict";var r=n(92952),a=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,o,i={};return e?(r.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=r.trim(e.substr(0,o)).toLowerCase(),n=r.trim(e.substr(o+1)),t){if(i[t]&&a.indexOf(t)>=0)return;i[t]="set-cookie"===t?(i[t]?i[t]:[]).concat([n]):i[t]?i[t]+", "+n:n}})),i):i}},82696:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},92952:(e,t,n)=>{"use strict";var r=n(22096),a=Object.prototype.toString;function o(e){return"[object Array]"===a.call(e)}function i(e){return void 0===e}function s(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===a.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.call(null,e[a],a,e)}e.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===a.call(e)},isBuffer:function(e){return null!==e&&!i(e)&&null!==e.constructor&&!i(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isUndefined:i,isDate:function(e){return"[object Date]"===a.call(e)},isFile:function(e){return"[object File]"===a.call(e)},isBlob:function(e){return"[object Blob]"===a.call(e)},isFunction:c,isStream:function(e){return s(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:u,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,a=arguments.length;r<a;r++)u(arguments[r],n);return t},deepMerge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]="object"==typeof n?e({},n):n}for(var r=0,a=arguments.length;r<a;r++)u(arguments[r],n);return t},extend:function(e,t,n){return u(t,(function(t,a){e[a]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},88538:e=>{var t,n,r=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var s,c=[],u=!1,l=-1;function _(){u&&s&&(u=!1,s.length?c=s.concat(c):l=-1,c.length&&d())}function d(){if(!u){var e=i(_);u=!0;for(var t=c.length;t;){for(s=c,c=[];++l<t;)s&&s[l].run();l=-1,t=c.length}s=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function h(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new f(e,t)),1!==c.length||u||i(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=h,r.addListener=h,r.once=h,r.off=h,r.removeListener=h,r.removeAllListeners=h,r.emit=h,r.prependListener=h,r.prependOnceListener=h,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(18731);let t={add:function(e,t,n){var r={};r[e]=t,chrome.storage.local.set(r,(function(){chrome.runtime.lastError&&console.log("error on retrieving from local storage");const t={status:!0,data:r[e],message:`O item ${e} foi adicionado.`};n&&n(t)}))},get:function(e,t){chrome.storage.local.get(e,(function(e){chrome.runtime.lastError&&console.log("error on retrieving from local storage");const n=Object.keys(e).length>0?{exist:!0,data:e}:{exist:!1,data:null};t&&t(n)}))},getAsync:function(e){return new Promise((t=>{chrome.storage.local.get(e,(n=>{t(n[e]??null)}))}))},addSync:function(e,t,n){var r={};r[e]=t,chrome.storage.sync.set(r,(function(){chrome.runtime.lastError&&console.log("error on retrieving from sync storage");const t={status:!0,data:r[e],message:`O item ${e} foi adicionado.`};n&&n(t)}))},getSync:function(e,t){chrome.storage.sync.get(e,(function(e){chrome.runtime.lastError&&console.log("error on retrieving from sync storage");const n=Object.keys(e).length>0?{exist:!0,data:e}:{exist:!1,data:null};t&&t(n)}))},getAll:function(){return new Promise((e=>{chrome.storage.local.get(null,(function(t){var n=Object.keys(t);e(n)}))}))},remove:function(e,t){chrome.storage.local.remove(e,(function(){chrome.runtime.lastError&&console.log("error on retrieving from local storage");t&&t({status:!0,message:`O item ${e} foi removido.`})}))},removeAsync:function(e){return new Promise((t=>{chrome.storage.local.remove(e,(()=>{t(null)}))}))},addCache(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;return new Promise(((r,a)=>{if(!e||!n)return a(new Error("key or expire time not undefined"));var o={value:t,expiresAt:(new Date).getTime()+n};this.add(e.toString(),o,(e=>r(e)))}))},addCacheEtag(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise(((a,o)=>{if(!e||!n)return o(new Error("key or expire time not undefined"));var i={value:t,etag:r,caches_until:(new Date).getTime()+n};this.add(e.toString(),i,(e=>a(e)))}))},async getCacheEtag(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const{config:a}=await chrome.storage.local.get("config"),{requestCacheLibRetry:o}=(null==a?void 0:a.value)||{};let i=null;return o&&o.enabled&&(i={attempts:o.attempts??0,delayInMs:o.delayInMs??0}),_("extensionLocalStorage").handleRequestUsingCache({uniqueKey:e,requestUrl:t,expirationInMilliseconds:n,options:r,retry:i})},getValid:e=>_("extensionLocalStorage").getValid(e),set:(e,t,n,r)=>_("extensionLocalStorage").set({key:e,value:t,timeToExpire:n,eTag:r}),setSetting(e,t){return new Promise((n=>{this.get("settings",(r=>{var a;let o=(null===(a=r.data)||void 0===a?void 0:a.settings)||{};o[e]=t,this.add("settings",o,(()=>n()))}))}))},getSetting(e){return new Promise((t=>{this.get("settings",(n=>{if(!n.exist)return t(null);t(n.data.settings[e]??null)}))}))},getCache(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise((n=>{chrome.storage.local.get(e.toString(),(r=>{if(Object.keys(r).length>0){let a=r[e];if((null==a?void 0:a.expiresAt)>(new Date).getTime())return n(a.value??a);if(!t)return n();this.remove(e)}n(null)}))}))},updateCache(e,t){return new Promise((n=>{chrome.storage.local.get(e.toString(),(r=>{if(Object.keys(r).length>0){let a=r[e],o={value:t,expiresAt:a.expiresAt};this.add(e.toString(),o,(e=>n(e)))}}))}))},getSession:async e=>chrome.storage.session.get(e).then((t=>t[e])),addSession(e,t,n){const r={};r[e]=n?{value:t,expiresAt:(new Date).getTime()+n}:t,chrome.storage.session.set(r)},removeSession(e){chrome.storage.session.remove(e)},async addStoreToPaymentTracker(e,t){let n=await this.getSession("payment_tracker"),r={};n&&Object.keys(t).length&&(r=n),r[t]||(r[t]=""),r[t].includes(e)||(r[t]=e),this.addSession("payment_tracker",r)},async getStorePaymentType(e){return new Promise((t=>{this.getSession("payment_tracker").then((n=>t(null==n?void 0:n[e])))}))},async removeStorePaymentType(e){let t=await this.getSession("payment_tracker");t[e]&&delete t[e],this.addSession("payment_tracker",t)},async addStoreToRememberList(e,t){let n=await this.getSession("remember"),r={};n&&Object.keys(n).length&&(r=n),r[e]||(r[e]=[]),r[e].includes(t)||r[e].push(t),this.addSession("remember",r)},storeExistOnRememberList(e,t){return new Promise((n=>{this.storesFromRememberList(e,(async e=>{n(e&&e.includes(t))}))}))},removeStoreFromRememberList(e,t){this.storesFromRememberList(e,(async n=>{if(!n)return;n.splice(n.indexOf(t),1);let r=await this.getSession("remember"),a={};r&&Object.keys(r).length&&(a=r),a[e]=n,this.addSession("remember",a)}))},async storesFromRememberList(e,t){let n=await this.getSession("remember");return t(null==n?void 0:n[e])},async removeKeySession(e,t){let n=await this.getSession("remember");n[e].includes(t)&&delete n[e],this.addSession("remember",n)},async isSessionKeyValid(e){let t=await this.getSession(e);return t&&t.expiresAt>(new Date).getTime()},getAllAndFilterByKey:async e=>new Promise((t=>{chrome.storage.local.get(null,(n=>{const r=Object.entries(n).filter((t=>{let[n,r]=t;return n.startsWith(e)&&r.value.hasVisited})).map((e=>{let[,t]=e;return{...t.value}}));t(r)}))})),getLocalStorage:async()=>new Promise((e=>{chrome.storage.local.get(null,(t=>{e(t)}))})),async removeStoreCaches(e){const t=await this.getLocalStorage(),n=Object.keys(t).reduce(((t,n)=>(e.find((e=>n===`cache_${e}`||n===`cache_${e}_core`))&&t.push(n),t)),[]);return this.remove(n),null}};const r=t;function a(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var o=null;function i(){if(null===o){let e=a();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),o=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return o}function s(){let e=a();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function c(){let e=i(),t=s(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=a();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var u="__INTENTIONAL_UNDEFINED__";let l={};function _(t){let n=c();if(void 0===n[t])return function(t){if("extensionLocalStorage"===t)return e.wS;return}(t);var r=n[t];return r===u?void 0:r}function d(e,t){let n=c();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){f(e)}))}):(n[e]=void 0===t?u:t,function(){f(e)})}function f(e){let t=c();delete t[e],0==Object.keys(t).length&&delete s()[i]}function h(e){let t=c();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(l,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",_),e("__GetDependency__",_),e("__Rewire__",d),e("__set__",d),e("__reset__",f),e("__ResetDependency__",f),e("__with__",h)}();function g(e,n){Object.defineProperty(t,e,{value:n,enumerable:!1,configurable:!0})}Object.isExtensible(t)&&(g("__get__",_),g("__GetDependency__",_),g("__Rewire__",d),g("__set__",d),g("__reset__",f),g("__ResetDependency__",f),g("__with__",h),g("__RewireAPI__",l));const p=(e,t,n)=>new Promise((r=>{chrome.runtime.sendMessage({action:"processEvent",data:{store:n,eventName:e,eventData:t}},r())}));async function m(e){var t;return(null===(t=(await G("getExtensionConfig")()).features[e])||void 0===t?void 0:t.disabled)??!1}function b(e){return new Promise((t=>{chrome.runtime.sendMessage({action:"getExtensionConfig",page:e},(function(e){t(e)}))}))}const E=e=>new Promise((t=>{chrome.runtime.sendMessage({action:"getSimilarProductsConfig",page:e},(function(e){t(e)}))})),y=e=>{let t=document.createElement("script");t.src=chrome.runtime.getURL(`/${e}`),document.head.appendChild(t)},v=e=>new Promise((t=>{chrome.runtime.sendMessage({action:"checkWebsite",data:{url:e}},(function(e){if(e&&e.store&&e.store.options)return t(e.store.options);t(null)}))})),w=e=>new Promise((t=>{chrome.runtime.sendMessage({action:"getStore",data:{slug:e}},(function(e){if(e&&e.store)return t(e.store);t(null)}))})),R=(e,t)=>{let n=new Date(e),r=new Date(t);return Math.floor((Date.UTC(r.getFullYear(),r.getMonth(),r.getDate())-Date.UTC(n.getFullYear(),n.getMonth(),n.getDate()))/864e5)};async function O(e){return await chrome.runtime.sendMessage({action:"isFeatureEnabled",data:{feature:e}})}async function I(e,t){return await chrome.runtime.sendMessage({action:"isFeatureDisabledInStore",data:{feature:e,slug:t}})}async function L(e,t){return await chrome.runtime.sendMessage({action:"isStoreInDenylist",data:{feature:e,slug:t}})}async function T(e){return await chrome.runtime.sendMessage({action:"getFeatureConfig",data:{feature:e}})}function S(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var C=null;function k(){if(null===C){let e=S();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),C=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return C}function $(){let e=S();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function A(){let e=k(),t=$(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=S();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var D="__INTENTIONAL_UNDEFINED__";let j={};function G(e){let t=A();if(void 0===t[e])return function(e){switch(e){case"emit":return p;case"getExtensionConfig":return b}return}(e);var n=t[e];return n===D?void 0:n}function N(e,t){let n=A();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){P(e)}))}):(n[e]=void 0===t?D:t,function(){P(e)})}function P(e){let t=A();delete t[e],0==Object.keys(t).length&&delete $()[k]}function B(e){let t=A();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(j,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",G),e("__GetDependency__",G),e("__Rewire__",N),e("__set__",N),e("__reset__",P),e("__ResetDependency__",P),e("__with__",B)}();var U=n(83957),x=n.n(U);function M(){return(new Date).toLocaleDateString("pt-BR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric"})}Date.prototype.addDays=function(e){const t=new Date(this.valueOf());return t.setDate(t.getDate()+e),t};const W=(e,t)=>!(!e||!t)&&new Date(e)>new Date(t),H=()=>{let e=new Date;const t=e=>`0${e}`.slice(-2);return`${e.getFullYear()}-${t(e.getMonth()+1)}-${t(e.getDate())} ${t(e.getHours())}:${t(e.getMinutes())}:${t(e.getSeconds())}`},F=e=>Math.floor(e/36e5),Y=e=>Math.floor(e%36e5/6e4),q=e=>Math.floor(e%6e4/1e3),X=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate();function V(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var z=null;function K(){if(null===z){let e=V();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),z=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return z}function J(){let e=V();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Q(){let e=K(),t=J(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=V();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Z="__INTENTIONAL_UNDEFINED__";let ee={};function te(e){let t=Q();if(void 0===t[e])return function(e){switch(e){case"getHourByTimeInMs":return F;case"getMinutesByTimeInMs":return Y;case"getSecondsByTimeInMs":return q}return}(e);var n=t[e];return n===Z?void 0:n}function ne(e,t){let n=Q();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){re(e)}))}):(n[e]=void 0===t?Z:t,function(){re(e)})}function re(e){let t=Q();delete t[e],0==Object.keys(t).length&&delete J()[K]}function ae(e){let t=Q();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(ee,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",te),e("__GetDependency__",te),e("__Rewire__",ne),e("__set__",ne),e("__reset__",re),e("__ResetDependency__",re),e("__with__",ae)}();class oe{constructor(e){this.baseUrl=e}async getData(){return await ge("db").getCacheEtag("data",`${this.baseUrl}data.json`,await ge("generalHelper").getCache("data"))||{}}async getNotificationsWhitelist(){return await ge("db").getCacheEtag("notifications-whitelist",`${this.baseUrl}notifications-whitelist.json`,await ge("generalHelper").getCache("notifications-whitelist"))||[]}async getThankYouStores(){return await ge("db").getCacheEtag("thankyou",`${this.baseUrl}thankyou.json`,await ge("generalHelper").getCache("thankyou"))||[]}async getHosts(){const e=`${this.baseUrl}hosts.json`,t=await ge("generalHelper").getCache("hosts");let n={};try{n=await ge("db").getCacheEtag("hosts",e,t)}catch(e){console.log("Error getting hosts",e)}return n}async getCouponTester(){return await ge("db").getCacheEtag("coupon-tester",`${this.baseUrl}coupon-tester.json`,await ge("generalHelper").getCache("coupon-tester"))||[]}async getGenericCoupons(){return await ge("db").getCacheEtag("coupons",`${this.baseUrl}coupons.json`,await ge("generalHelper").getCache("coupons"))||[]}async getPopupConfig(){return await ge("db").getCacheEtag("popup",`${this.baseUrl}popup.json`,await ge("generalHelper").getCache("popup"))||{}}async getSimilarProduct(){return await ge("db").getCacheEtag("similar-products",`${this.baseUrl}similar-products.json`,await ge("generalHelper").getCache("similar-products"))||[]}async getCompetitors(){return await ge("db").getCacheEtag("competitors",`${this.baseUrl}competitors.json`,await ge("generalHelper").getCache("competitors"))||[]}async getExtensions(){return await ge("db").getCacheEtag("extensions",`${this.baseUrl}extensions.json`,await ge("generalHelper").getCache("extensions"))||[]}async getExtensionConfig(){return await ge("db").getCacheEtag("config",`${this.baseUrl}config.json`,36e5)||{}}async getStoreRelations(){return await ge("db").getCacheEtag("store-relations",`${this.baseUrl}store-relations.json`,await ge("generalHelper").getCache("store-relations"))||[]}async getJSON(e){const t=await ge("generalHelper").getCache(e),n=`${this.baseUrl}${e}.json`;return await ge("db").getCacheEtag(e,n,t)||{}}async getContentScript(e){return await ge("db").getCacheEtag(`content-scripts/${e}`,`content-scripts/${e}`,await ge("generalHelper").getCache("content-scripts-files"))||""}async getWarnings(){return await ge("db").getCacheEtag("warnings",`${this.baseUrl}warnings.json`,await ge("generalHelper").getCache("warnings"))||[]}isInvalidJSON(e){const t=e.headers["content-type"].includes("application/json"),n="string"==typeof e.data;return t&&n}async sendPurchase(e,t){let n={data:e,cookies:await ge("generalHelper").getTrackingData(t),dateTime:ge("getDateTime")()};ge("axios").post("https://qi1uazf5s1.execute-api.us-east-1.amazonaws.com/Prod/extension-information",n).finally((()=>{}))}async getBanners(){const e=await ge("db").getCacheEtag("banners",`${this.baseUrl}banners.json`,await ge("generalHelper").getCache("banners")),t=0===Object.keys(e||{}).length;if(!e||t)return[];const{banners:n=[]}=e;return n.filter((e=>{const t=ge("isFirstAfterSecondDate")(new Date,new Date(e.startDate)),n=ge("isFirstAfterSecondDate")(new Date(e.endDate),new Date);return t&&n}))}}let ie=new(ge("AmazonRestClient"))("https://d2iv4x4t7ozxv2.cloudfront.net/");const se=ie;function ce(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var ue=null;function le(){if(null===ue){let e=ce();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),ue=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return ue}function _e(){let e=ce();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function de(){let e=le(),t=_e(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=ce();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var fe="__INTENTIONAL_UNDEFINED__";let he={};function ge(e){let t=de();if(void 0===t[e])return function(e){switch(e){case"db":return r;case"generalHelper":return Tr;case"getDateTime":return M;case"axios":return x();case"isFirstAfterSecondDate":return W;case"AmazonRestClient":return oe}return}(e);var n=t[e];return n===fe?void 0:n}function pe(e,t){let n=de();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){me(e)}))}):(n[e]=void 0===t?fe:t,function(){me(e)})}function me(e){let t=de();delete t[e],0==Object.keys(t).length&&delete _e()[le]}function be(e){let t=de();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(he,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",ge),e("__GetDependency__",ge),e("__Rewire__",pe),e("__set__",pe),e("__reset__",me),e("__ResetDependency__",me),e("__with__",be)}();let Ee=typeof ie;function ye(e,t){Object.defineProperty(ie,e,{value:t,enumerable:!1,configurable:!0})}"object"!==Ee&&"function"!==Ee||!Object.isExtensible(ie)||(ye("__get__",ge),ye("__GetDependency__",ge),ye("__Rewire__",pe),ye("__set__",pe),ye("__reset__",me),ye("__ResetDependency__",me),ye("__with__",be),ye("__RewireAPI__",he));class ve{constructor(e){this.baseURL=e}saveEventWith(e){fetch(this.baseURL+"/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e})}}let we=new($e("EventsRestClient"))("https://05u19b337b.execute-api.us-east-1.amazonaws.com/prod/e");const Re=we;function Oe(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var Ie=null;function Le(){if(null===Ie){let e=Oe();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),Ie=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return Ie}function Te(){let e=Oe();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Se(){let e=Le(),t=Te(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=Oe();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Ce="__INTENTIONAL_UNDEFINED__";let ke={};function $e(e){let t=Se();if(void 0===t[e])return function(e){if("EventsRestClient"===e)return ve;return}(e);var n=t[e];return n===Ce?void 0:n}function Ae(e,t){let n=Se();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){De(e)}))}):(n[e]=void 0===t?Ce:t,function(){De(e)})}function De(e){let t=Se();delete t[e],0==Object.keys(t).length&&delete Te()[Le]}function je(e){let t=Se();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(ke,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",$e),e("__GetDependency__",$e),e("__Rewire__",Ae),e("__set__",Ae),e("__reset__",De),e("__ResetDependency__",De),e("__with__",je)}();let Ge=typeof we;function Ne(e,t){Object.defineProperty(we,e,{value:t,enumerable:!1,configurable:!0})}"object"!==Ge&&"function"!==Ge||!Object.isExtensible(we)||(Ne("__get__",$e),Ne("__GetDependency__",$e),Ne("__Rewire__",Ae),Ne("__set__",Ae),Ne("__reset__",De),Ne("__ResetDependency__",De),Ne("__with__",je),Ne("__RewireAPI__",ke));let Pe={signInWithStore:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"cuponomia.com.br";return new Promise((o=>{const i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};qe("tabHelper").executeInAllTabs({url:n+"/*"},(n=>qe("tabHelper").sendMessage(n.id,e,null,{...t,group:"auth",originTabId:r})))};qe("tabHelper").createTab(e,t,(e=>{function t(n,r,a){e.id!==n&&"complete"!==r.status||(qe("tabHelper").remove(n),chrome.tabs.onUpdated.removeListener(t))}i("initialize",{authTabId:e.id}),chrome.tabs.onUpdated.addListener((function n(r,o,i){o.title||e.id!==r||i.url.indexOf(a)>-1||(chrome.tabs.onUpdated.removeListener(n),chrome.tabs.onUpdated.addListener(t))})),chrome.tabs.onRemoved.addListener((t=>{e.id===t&&(r&&chrome.tabs.update(r,{active:!0}),i("finish"),o())}))}))}))},getUser:function(){let e={domain:new URL("https://www.cuponomia.com.br/").host};return new Promise(((t,n)=>{chrome.cookies.getAll(e,(e=>{let n=null,r=e.filter((e=>!e.domain.includes("admin")&&"e"===e.name));r.length&&(n=r.shift().value),t(n)}))}))},isUserAuthenticated:function(){let e={domain:new URL("https://www.cuponomia.com.br/").host};return new Promise(((t,n)=>{chrome.cookies.getAll(e,(e=>{let n=e.filter((e=>!e.domain.includes("admin")&&"accessToken"===e.name));t(!!n.length)}))}))},getUuid:function(){let e={domain:new URL("https://www.cuponomia.com.br/").host};return new Promise(((t,n)=>{chrome.cookies.getAll(e,(e=>{let n=null,r=e.filter((e=>!e.domain.includes("admin")&&"uuid"===e.name));r.length&&(n=r.shift().value),t(n)}))}))}};const Be=Pe;function Ue(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var xe=null;function Me(){if(null===xe){let e=Ue();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),xe=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return xe}function We(){let e=Ue();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function He(){let e=Me(),t=We(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=Ue();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Fe="__INTENTIONAL_UNDEFINED__";let Ye={};function qe(e){let t=He();if(void 0===t[e])return function(e){if("tabHelper"===e)return Wr;return}(e);var n=t[e];return n===Fe?void 0:n}function Xe(e,t){let n=He();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Ve(e)}))}):(n[e]=void 0===t?Fe:t,function(){Ve(e)})}function Ve(e){let t=He();delete t[e],0==Object.keys(t).length&&delete We()[Me]}function ze(e){let t=He();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(Ye,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",qe),e("__GetDependency__",qe),e("__Rewire__",Xe),e("__set__",Xe),e("__reset__",Ve),e("__ResetDependency__",Ve),e("__with__",ze)}();function Ke(e,t){Object.defineProperty(Pe,e,{value:t,enumerable:!1,configurable:!0})}function Je(){const e="até ",t={FIXED:"fixed",PERCENTAGE:"percentage"},n="action",r="vip",a=e=>{if(!e)return!1;if(!e.hasOwnProperty("value"))return!1;if(!e.hasOwnProperty("type"))return!1;const n=e.type===t.FIXED,r=e.type===t.PERCENTAGE;return n||r},o=e=>null==e?void 0:e.isUpTo,i=e=>e.value,s=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(e).replace(/\s/g,""),c=e=>new Intl.NumberFormat("pt-BR",{style:"percent",maximumFractionDigits:2}).format(e),u=(e,n)=>{if(isNaN(e))return"0";return n===t.FIXED?s(e):c(e)},l=e=>{if(!e||0==Object.keys(e).length)return!1;const t=e.hasOwnProperty("originalCashback");if(!t)return!1;const n=e.originalCashback.hasOwnProperty("value"),r=e.originalCashback.hasOwnProperty("type");return t&&n&&r},_=e=>!(null==e||!e.isBoosted);return{formatCashback:t=>{if(!a(t))return"0";const n=t.type,r=i(t);if(0===r)return"Cashback Indisponível";const s=u(r,n),c=o(t);return 0===r?r:(c?e:"")+s},formatOriginalCashback:e=>{if(!l(e))return"";const t=e.originalCashback.type;return t?"fixed"===t?`(era ${s(e.originalCashback.value)})`:"percentage"===t?`(era ${c(e.originalCashback.value)})`:void 0:""},formatPrimeCashback:t=>{if(!a(t.cashbackWithoutPrime))return"";const n=t.cashbackWithoutPrime.type,r=i(t.cashbackWithoutPrime),s=u(r,n);return(o(t)?e:"")+s+" sem Cuponomia Prime"},getCashbackBadge:e=>!!_(e)&&(e.boostType===n?{type:"superCashback",color:"#8459b4",text:"Super cashback"}:e.boostType===r&&{type:"userVip",color:"#E59B1F",text:"Cashback VIP"}),storeHasValidCashback:e=>{if(!!!e)return!1;if(!e.hasOwnProperty("cashback"))return!1;return a(e.cashback)},hasValidOriginalCashback:l,CheckShouldDisplayUpToMessage:o,formatFixedCashback:s,formatPercentageCashback:c,getCashbackSegmentationByType:(e,t)=>{if(!e||null==e||!e.cashback||!t)return[];const n=(e.cashback.segmentations??[]).find((e=>e.type===t));return(null==n?void 0:n.items)??[]},hasCashbackBadge:_,CASHBACK_TYPES:t,isPrime:e=>!(null==e||!e.isPrime),isSuperCashbackAndLastDay:e=>{if(!_(e))return!1;if(e.boostType!==n)return!1;const t=new Date,r=new Date(e.boostEndDate);return ot("isSameDate")(t,r)},hasSegments:e=>{var t;return(null==e||null===(t=e.segmentations)||void 0===t?void 0:t.length)>0},hasUnavailableCashback:e=>0===i(e),isSuperCashback:e=>!!_(e)&&e.boostType===n}}function Qe(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}Object.isExtensible(Pe)&&(Ke("__get__",qe),Ke("__GetDependency__",qe),Ke("__Rewire__",Xe),Ke("__set__",Xe),Ke("__reset__",Ve),Ke("__ResetDependency__",Ve),Ke("__with__",ze),Ke("__RewireAPI__",Ye));var Ze=null;function et(){if(null===Ze){let e=Qe();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),Ze=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return Ze}function tt(){let e=Qe();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function nt(){let e=et(),t=tt(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=Qe();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var rt="__INTENTIONAL_UNDEFINED__";let at={};function ot(e){let t=nt();if(void 0===t[e])return function(e){if("isSameDate"===e)return X;return}(e);var n=t[e];return n===rt?void 0:n}function it(e,t){let n=nt();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){st(e)}))}):(n[e]=void 0===t?rt:t,function(){st(e)})}function st(e){let t=nt();delete t[e],0==Object.keys(t).length&&delete tt()[et]}function ct(e){let t=nt();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(at,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",ot),e("__GetDependency__",ot),e("__Rewire__",it),e("__set__",it),e("__reset__",st),e("__ResetDependency__",st),e("__with__",ct)}();const ut=async e=>{var t;return(null===(t=(await yt("AmazonClient").getJSON("features"))[e])||void 0===t?void 0:t.enabled)??!1},lt=async(e,t)=>{var n,r,a;const o=await yt("AmazonClient").getJSON("features");if(!!(null===(n=o[e])||void 0===n||!n.enabled))return!1;return null===(r=o[e])||void 0===r||null===(a=r.enabledStores)||void 0===a?void 0:a.includes(t)},_t=async(e,t)=>{var n,r,a;const o=await yt("AmazonClient").getJSON("features");if(!!(null===(n=o[e])||void 0===n||!n.enabled))return!0;return null===(r=o[e])||void 0===r||null===(a=r.disabledStores)||void 0===a?void 0:a.includes(t)},dt=async e=>{const t=await yt("AmazonClient").getJSON("features");return e in t?t[e]:null};function ft(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var ht=null;function gt(){if(null===ht){let e=ft();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),ht=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return ht}function pt(){let e=ft();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function mt(){let e=gt(),t=pt(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=ft();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var bt="__INTENTIONAL_UNDEFINED__";let Et={};function yt(e){let t=mt();if(void 0===t[e])return function(e){switch(e){case"AmazonClient":return se;case"isFeatureDisabledInStore":return _t;case"isFeatureEnabledInStore":return lt;case"getFeatureConfig":return dt}return}(e);var n=t[e];return n===bt?void 0:n}function vt(e,t){let n=mt();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){wt(e)}))}):(n[e]=void 0===t?bt:t,function(){wt(e)})}function wt(e){let t=mt();delete t[e],0==Object.keys(t).length&&delete pt()[gt]}function Rt(e){let t=mt();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(Et,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",yt),e("__GetDependency__",yt),e("__Rewire__",vt),e("__set__",vt),e("__reset__",wt),e("__ResetDependency__",wt),e("__with__",Rt)}();class Ot{constructor(){}captureException(e){throw new Error("captureException method must be overridden.")}}class It extends(Dt("ErrorManager")){constructor(){super()}captureException(e){console.error(e)}}function Lt(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var Tt=null;function St(){if(null===Tt){let e=Lt();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),Tt=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return Tt}function Ct(){let e=Lt();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function kt(){let e=St(),t=Ct(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=Lt();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var $t="__INTENTIONAL_UNDEFINED__";let At={};function Dt(e){let t=kt();if(void 0===t[e])return function(e){if("ErrorManager"===e)return Ot;return}(e);var n=t[e];return n===$t?void 0:n}function jt(e,t){let n=kt();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Gt(e)}))}):(n[e]=void 0===t?$t:t,function(){Gt(e)})}function Gt(e){let t=kt();delete t[e],0==Object.keys(t).length&&delete Ct()[St]}function Nt(e){let t=kt();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(At,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Dt),e("__GetDependency__",Dt),e("__Rewire__",jt),e("__set__",jt),e("__reset__",Gt),e("__ResetDependency__",Gt),e("__with__",Nt)}();let Pt=typeof It;function Bt(e,t){Object.defineProperty(It,e,{value:t,enumerable:!1,configurable:!0})}"object"!==Pt&&"function"!==Pt||!Object.isExtensible(It)||(Bt("__get__",Dt),Bt("__GetDependency__",Dt),Bt("__Rewire__",jt),Bt("__set__",jt),Bt("__reset__",Gt),Bt("__ResetDependency__",Gt),Bt("__with__",Nt),Bt("__RewireAPI__",At));const Ut=async()=>new(Vt("ConsoleErrorManager")),xt=async e=>{(await Vt("getErrorManager")()).captureException(new Error(e))};function Mt(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var Wt=null;function Ht(){if(null===Wt){let e=Mt();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),Wt=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return Wt}function Ft(){let e=Mt();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Yt(){let e=Ht(),t=Ft(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=Mt();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var qt="__INTENTIONAL_UNDEFINED__";let Xt={};function Vt(e){let t=Yt();if(void 0===t[e])return function(e){switch(e){case"ConsoleErrorManager":return It;case"getErrorManager":return Ut}return}(e);var n=t[e];return n===qt?void 0:n}function zt(e,t){let n=Yt();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Kt(e)}))}):(n[e]=void 0===t?qt:t,function(){Kt(e)})}function Kt(e){let t=Yt();delete t[e],0==Object.keys(t).length&&delete Ft()[Ht]}function Jt(e){let t=Yt();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(Xt,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Vt),e("__GetDependency__",Vt),e("__Rewire__",zt),e("__set__",zt),e("__reset__",Kt),e("__ResetDependency__",Kt),e("__with__",Jt)}();const{storeHasValidCashback:Qt}=ln("useCashback")();class Zt{constructor(e){this.baseUrl=e}async getStatement(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=await ln("db").getCache("user_statement");if((null===(t=r)||void 0===t?void 0:t.user)===e&&r[n])return{cashbacks:r[n],totalPages:r.totalPages};let a=await fetch(`https://www.cuponomia.com.br/ext/account/statement?page=${n}`,{method:"get",headers:{"api-version":3}}).then((e=>e.json()));return Object.keys(a).length?(r&&r.user===e||(r={user:e,totalPages:a.totalPages}),r[n]=a.cashbacks,ln("db").addCache("user_statement",r,await ln("generalHelper").getCache("user-statement")),a):null}async getDataStore(e,t){if(!e)return{store:{bestCoupons:[]},slug:e};const n=await ln("generalHelper").getCache("store-data"),r=`https://www.cuponomia.com.br/ext/stores/${e}`,a={"api-version":3};try{const t=await ln("db").getCacheEtag(`cache_${e}`,r,n,a);return Object.keys(t).length?{store:{...t},slug:e}:{store:{bestCoupons:[]},slug:e}}catch{return{store:{bestCoupons:[]},slug:e}}}async getStoreFeed(e,t){if(!e)return{store:{bestCoupons:[]},slug:e};const n=await ln("generalHelper").getCache("store-data"),r=`https://www.cuponomia.com.br/ext/stores/${e}/feed`,a={"api-version":3};try{const t=await ln("db").getCacheEtag(`cache_${e}`,r,n,a);if(!Object.keys(t).length)return{store:{bestCoupons:[]},slug:e};if(!["bestCoupons","similarStores"].every((e=>null==t?void 0:t[e]))){var o;const t=`https://www.cuponomia.com.br/ext/stores/${e}/feed`,r=await ln("db").getCacheEtag(`cache_temp_${e}`,t,n,a);if(!Object.keys(r).length)return ln("db").remove(`cache_temp_${e}`),{store:{bestCoupons:[]},slug:e};const i=(new Date).getTime()+n,s={bestCoupons:(null==r?void 0:r.bestCoupons)||[],similarStores:(null==r?void 0:r.similarStores)||[]},c={...r,numberOfCoupons:null==r||null===(o=r.bestCoupons)||void 0===o?void 0:o.length,...s};return ln("db").set(`cache_${e}`,c,i),ln("db").remove(`cache_temp_${e}`),{store:{...c},slug:e}}return{store:{...t},slug:e}}catch{return{store:{bestCoupons:[]},slug:e}}}async getDataProductSimilar(e){const t=`https://6d3n67ye30.execute-api.sa-east-1.amazonaws.com/prod/hyperion?${e}`,n=await fetch(t,{method:"GET"});return n.data=await n.json(),n.data}async getDataAccount(){const e="user_data",t=await ln("db").getAsync(e);Object.keys((null==t?void 0:t.value)||{}).length>0||await ln("db").removeAsync(e);return await ln("db").getCacheEtag(e,""+(this.baseUrl+"ext/account/profile"),await ln("generalHelper").getCache("user-data"),{"Content-Type":"application/json","X-Content-Type-Options":"nosniff"})}async getDataCampaign(){return await ln("db").getCacheEtag("referral_campaign",""+(this.baseUrl+"ext/campaign/referral"),await ln("generalHelper").getCache("referral-campaign"))}async getAccountBalance(e){if(!e)return 0;const t=await ln("generalHelper").getCache("user-balance");return await ln("db").getCacheEtag("user_balance","https://www.cuponomia.com.br/ext/account/balance",t||ln("generalHelper").millisecondsPerMinutes(30))}async sendFeedbackProductSimilar(e){}async sendStoreTracker(e,t){const n=e.find((e=>"slug"===e.Key)),r=`https://www.cuponomia.com.br/ext/stores/${(null==n?void 0:n.Value)||""}/notify-ri-page-view?${t}`;return await fetch(r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({Parameters:e})})}async getTopStores(){const e=await ln("db").getCacheEtag("top_stores",`${this.baseUrl}ext/featured/stores`,await ln("generalHelper").getCache("top-stores"),{"api-version":3}),t=null==e?void 0:e.filter((e=>ln("storeHasValidCashback")(e))).slice(0,3);return t}async sendGreenTransaction(e){if(!e.uuid)return;return fetch("https://www.cuponomia.com.br/ext/green-transaction",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({Slug:e.store.slug,UniversalId:e.uuid})}).then((e=>e.json()))}async getStoresBySearch(e){if(null==e||!e.searchTerm)return[];return await fetch(`https://www.cuponomia.com.br/ext/stores/search?query=${encodeURIComponent(e.searchTerm)}`,{method:"GET",headers:{"api-version":3}}).then((e=>e.json()))}async searchBestOffers(e){if(!e)return[];const t=await fetch(`https://www.cuponomia.com.br/ext/offers/search?query=${e}`,{method:"GET",headers:{"api-version":3}}).then((e=>e.json())),n=await ln("getFeatureConfig")("search-best-offers"),r=(null==n?void 0:n.blacklist)||[];return t.itens=t.itens.filter((e=>!r.includes(e.store.slug))),t}async getBestOffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=""!==t?`best_offers_${t}`:"best_offers";let r=await ln("db").getCache(n);if(r&&r[e])return{totalCount:r.totalCount,itens:r[e]};const a=""!==t?`https://www.cuponomia.com.br/ext/stores/${t}/offers?page=${e}`:`https://www.cuponomia.com.br/ext/offers?page=${e}`;let o=await fetch(a,{method:"get",headers:{"api-version":3}}).then((e=>e.json()));if(!Object.keys(null==o?void 0:o.itens).length)return null;r||(r={});const i=await ln("getFeatureConfig")("best-offers"),s=(null==i?void 0:i.blacklist)||[];return o.itens=o.itens.filter((e=>!s.includes(e.store.slug))),r[e]=o.itens,r.totalCount=o.totalCount,ln("db").addCache(n,r,await ln("generalHelper").getCache("best-offers")),{totalCount:o.totalCount,itens:o.itens}}async getData(e){let{url:t,cacheName:n,cacheTimeKey:r}=e;if(!t||!n||!r)return null;let a=null;try{const e=await ln("generalHelper").getCache(r);a=await ln("db").getCacheEtag(n,`${this.baseUrl+t}`,e||ln("generalHelper").millisecondsPerMinutes(360))}catch(e){console.error(`ERROR - GET DATA FROM: ${t}`)}return a}async getCashbackById(e){if(!e)return{hasError:!0,data:null};try{const t=`https://www.cuponomia.com.br/ext/stores/${e}/cashback`,n=await fetch(t,{method:"get",headers:{"Content-Type":"application/json","api-version":3}});return 204===n.status?{hasError:!1,data:null}:{hasError:!1,data:await n.json()}}catch(e){return ln("sendErrorMessage")(`Error in: ${e}`),{hasError:!0,data:null}}}}let en=new(ln("CuponomiaRestClient"))("https://www.cuponomia.com.br/");const tn=en;function nn(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var rn=null;function an(){if(null===rn){let e=nn();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),rn=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return rn}function on(){let e=nn();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function sn(){let e=an(),t=on(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=nn();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var cn="__INTENTIONAL_UNDEFINED__";let un={};function ln(e){let t=sn();if(void 0===t[e])return function(e){switch(e){case"useCashback":return Je;case"db":return r;case"generalHelper":return Tr;case"getDateTime":return M;case"storeHasValidCashback":return Qt;case"getFeatureConfig":return dt;case"sendErrorMessage":return xt;case"CuponomiaRestClient":return Zt}return}(e);var n=t[e];return n===cn?void 0:n}function _n(e,t){let n=sn();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){dn(e)}))}):(n[e]=void 0===t?cn:t,function(){dn(e)})}function dn(e){let t=sn();delete t[e],0==Object.keys(t).length&&delete on()[an]}function fn(e){let t=sn();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(un,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",ln),e("__GetDependency__",ln),e("__Rewire__",_n),e("__set__",_n),e("__reset__",dn),e("__ResetDependency__",dn),e("__with__",fn)}();let hn=typeof en;function gn(e,t){Object.defineProperty(en,e,{value:t,enumerable:!1,configurable:!0})}"object"!==hn&&"function"!==hn||!Object.isExtensible(en)||(gn("__get__",ln),gn("__GetDependency__",ln),gn("__Rewire__",_n),gn("__set__",_n),gn("__reset__",dn),gn("__ResetDependency__",dn),gn("__with__",fn),gn("__RewireAPI__",un));let pn={getData:async function(){let e=await In("generalHelper").ensureUserCookies();return{email:await In("loginHelper").getUser(),...e}},getUserInfo:async function(){return await In("loginHelper").getUser()},getUserUniversalId:async function(){return await In("loginHelper").getUuid()},getBalance:async function(){let e=await this.getUserInfo();return e?await In("CuponomiaRestClient").getAccountBalance(e):null},userRedeem:async function(){const e=await fetch("https://www.cuponomia.com.br/rewards/redeem",{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest"}}),t=await e.json();return{status:e.status,body:t}},getUserData:async function(){if(!await this.getUserUniversalId())return null;return await new Promise((async(e,t)=>{try{return e(await In("CuponomiaRestClient").getData({url:"ext/session",cacheName:"user_session",cacheTimeKey:"user-session"}))}catch(e){0}return e(null)}))},clearUserData:function(){return["referral-campaign"].forEach((e=>In("db").removeSession(e))),["user_data","referral-campaign","user_balance","top_stores","user_session","user_statement"].forEach((e=>In("db").remove(e))),!0},hasUserVip:async function(){if(!await In("loginHelper").getUser())return In("db").remove("user-vip"),!1;const e=await this.getUserData();return(null==e?void 0:e.isVip)??!1},getUserPreferences:async function(){var e;const t=[{id:"similar-products",label:"Produtos similares com cashback",checked:!0,position:1},{id:"toast-cashback",label:"Lembrete de ativação de cashback dentro da loja",checked:!0,position:2},{id:"modal-remember",label:"Lembrete de ativação de cashback fora da loja",checked:!0,position:3},{id:"toast-relations",label:"Sites similares com cashback",checked:!0,position:4},{id:"cart-modal",label:"Cupons no carrinho de compras",checked:!0,position:5},{id:"notifications",label:"Notificações de mega cashback",checked:!0,position:6}];let n=await new Promise((e=>In("db").get("user_preferences",(t=>{var n;return e(null==t||null===(n=t.data)||void 0===n?void 0:n.user_preferences)}))));return(null===(e=n)||void 0===e?void 0:e.length)!==t.length&&(n=n?t.map((e=>{const t=n.find((t=>t.id===e.id));return t&&(e.checked=t.checked),e})):t,In("db").add("user_preferences",n)),Object.defineProperty(n,"hasPreference",{value:function(e){var t;return null===(t=this.find((t=>t.id===e)))||void 0===t?void 0:t.checked}}),n},logout(){chrome.tabs.create({url:"https://www.cuponomia.com.br/sair",active:!1,pinned:!0,index:0},(e=>{let t=(n,r)=>(n===e.id&&"complete"===r.status&&(this.clearUserData(),chrome.tabs.remove(n),chrome.tabs.onUpdated.removeListener(t)),!0);chrome.tabs.onUpdated.addListener(t)}))},getUserProfileData:async()=>In("CuponomiaRestClient").getDataAccount()};const mn=pn;function bn(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var En=null;function yn(){if(null===En){let e=bn();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),En=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return En}function vn(){let e=bn();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function wn(){let e=yn(),t=vn(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=bn();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Rn="__INTENTIONAL_UNDEFINED__";let On={};function In(e){let t=wn();if(void 0===t[e])return function(e){switch(e){case"generalHelper":return Tr;case"loginHelper":return Be;case"CuponomiaRestClient":return tn;case"db":return r}return}(e);var n=t[e];return n===Rn?void 0:n}function Ln(e,t){let n=wn();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Tn(e)}))}):(n[e]=void 0===t?Rn:t,function(){Tn(e)})}function Tn(e){let t=wn();delete t[e],0==Object.keys(t).length&&delete vn()[yn]}function Sn(e){let t=wn();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(On,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",In),e("__GetDependency__",In),e("__Rewire__",Ln),e("__set__",Ln),e("__reset__",Tn),e("__ResetDependency__",Tn),e("__with__",Sn)}();function Cn(e,t){Object.defineProperty(pn,e,{value:t,enumerable:!1,configurable:!0})}Object.isExtensible(pn)&&(Cn("__get__",In),Cn("__GetDependency__",In),Cn("__Rewire__",Ln),Cn("__set__",Ln),Cn("__reset__",Tn),Cn("__ResetDependency__",Tn),Cn("__with__",Sn),Cn("__RewireAPI__",On));let kn={getMastersessionID:async function(){const e="emsid";let t=await Un("db").getCache(e);const n=await Un("generalHelper").getCache("extension-mastersession-id");return t&&"string"==typeof t&&""!==t.trim()||(t=Un("generalHelper").idGenerator()),Un("db").addCache(e,t,n),t}};const $n=kn;function An(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var Dn=null;function jn(){if(null===Dn){let e=An();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),Dn=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return Dn}function Gn(){let e=An();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Nn(){let e=jn(),t=Gn(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=An();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Pn="__INTENTIONAL_UNDEFINED__";let Bn={};function Un(e){let t=Nn();if(void 0===t[e])return function(e){switch(e){case"db":return r;case"generalHelper":return Tr}return}(e);var n=t[e];return n===Pn?void 0:n}function xn(e,t){let n=Nn();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Mn(e)}))}):(n[e]=void 0===t?Pn:t,function(){Mn(e)})}function Mn(e){let t=Nn();delete t[e],0==Object.keys(t).length&&delete Gn()[jn]}function Wn(e){let t=Nn();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(Bn,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Un),e("__GetDependency__",Un),e("__Rewire__",xn),e("__set__",xn),e("__reset__",Mn),e("__ResetDependency__",Mn),e("__with__",Wn)}();function Hn(e,t){Object.defineProperty(kn,e,{value:t,enumerable:!1,configurable:!0})}function Fn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.isExtensible(kn)&&(Hn("__get__",Un),Hn("__GetDependency__",Un),Hn("__Rewire__",xn),Hn("__set__",xn),Hn("__reset__",Mn),Hn("__ResetDependency__",Mn),Hn("__with__",Wn),Hn("__RewireAPI__",Bn));const Yn=!1;class qn{constructor(){if(Fn(this,"_instance",null),Fn(this,"readyTabIds",[]),Fn(this,"resolveReadyPromise",null),er("ForegroundHelper")._instance)return er("ForegroundHelper")._instance;er("ForegroundHelper")._instance=this}setForegroundReady(e){let{tabId:t=null}=e;if(!t)return;this.readyTabIds.some((e=>e===t))?er("isDevelopmentMode")&&console.log("[FOREGROUND HELPER] - ESTA TAB JA ESTA CARREGADA -",t):(this.readyTabIds.push(t),er("isDevelopmentMode")&&(console.log("[FOREGROUND HELPER] - ADICIONANDO TABID -",t),console.log("[FOREGROUND HELPER] - TAB IDS REGISTRADOS -",this.readyTabIds)),this.resolveReadyPromise&&(this.resolveReadyPromise({tabId:t}),er("isDevelopmentMode")&&console.log("[FOREGROUND HELPER] - CARREGAMENTO COMPLETO - RESOLVE -",t)))}waitForReady(e){let{tabId:t=null}=e;if(!t)return;if(!this.readyTabIds.some((e=>e===t)))return new Promise((e=>{this.resolveReadyPromise=e,er("isDevelopmentMode")&&console.log("[FOREGROUND HELPER] - ESPERANDO TAB COMPLETAR CARREGAMENTO -",t)}));er("isDevelopmentMode")&&console.log("[FOREGROUND HELPER] - ESTA TAB JA ESTA CARREGADA -",t)}removeTabIdFromReadyList(e){let{tabId:t=null}=e;if(!t)return;const n=this.readyTabIds.findIndex((e=>e===t));-1!==n&&(this.readyTabIds.splice(n,1),er("isDevelopmentMode")&&(console.log("[FOREGROUND HELPER] - REMOVENDO TABID -",t),console.log("[FOREGROUND HELPER] - TAB IDS REGISTRADOS -",this.readyTabIds)))}}function Xn(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var Vn=null;function zn(){if(null===Vn){let e=Xn();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),Vn=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return Vn}function Kn(){let e=Xn();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Jn(){let e=zn(),t=Kn(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=Xn();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Qn="__INTENTIONAL_UNDEFINED__";let Zn={};function er(e){let t=Jn();if(void 0===t[e])return function(e){switch(e){case"ForegroundHelper":return qn;case"isDevelopmentMode":return Yn}return}(e);var n=t[e];return n===Qn?void 0:n}function tr(e,t){let n=Jn();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){nr(e)}))}):(n[e]=void 0===t?Qn:t,function(){nr(e)})}function nr(e){let t=Jn();delete t[e],0==Object.keys(t).length&&delete Kn()[zn]}function rr(e){let t=Jn();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(Zn,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",er),e("__GetDependency__",er),e("__Rewire__",tr),e("__set__",tr),e("__reset__",nr),e("__ResetDependency__",nr),e("__with__",rr)}();function ar(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function or(e,t){return e.get(sr(e,t))}function ir(e,t,n){return e.set(sr(e,t),n),n}function sr(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var cr=new WeakMap,ur=new WeakMap;class lr{constructor(e,t){ar(this,cr,null),ar(this,ur,null),ir(cr,this,e),ir(ur,this,t)}async getHostsBySlug(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{slug:""};if(!e||null==e||!e.slug)return null;const{slug:t}=e,n=await or(ur,this).getHosts(),r=Object.entries(n).filter((e=>{let[n,r]=e;return r===t})).map((e=>{let[t]=e;return t}))??[];return r||null}async getStoreByUrl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{currentUrl:"",dataType:"main"};if(!e||null==e||!e.currentUrl)return null;const{currentUrl:t}=e;let n="";try{n=new URL(t).hostname+new URL(t).pathname}catch{n=t}const r=n.replace(/^(?:https?:\/\/)?(?:www\.)?/i,""),a=await or(ur,this).getHosts(),[,o]=Object.entries(a).find((e=>{let[t]=e;return new RegExp(`^([a-zA-Z0-9-]+\\.)*${t.replace(/\./g,"\\.")}`).test(r)}))??[];if(!o)return null;const i="feed"===e.dataType?or(cr,this).getStoreFeed:or(cr,this).getDataStore;return(await i.call(or(cr,this),o)).store}async getStoreByName(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:""};if(!e||null==e||!e.name)return null;const{name:t}=e,n=await or(ur,this).getHosts(),r=Object.values(n).find((e=>e.toLowerCase().replace(/[^a-zA-Z0-9+]/g,"")===t.toLowerCase().replace(/[^a-zA-Z0-9+]/g,"")));if(!r)return null;return(await or(cr,this).getDataStore(r)).store}async getStoreBySlug(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{slug:"",senderUrl:""};if(!e||null==e||!e.slug)return null;const{slug:t,senderUrl:n}=e;return(await or(cr,this).getDataStore(t,n)).store}async getAllSlugs(){const e=await or(ur,this).getHosts();return Object.values(e)}escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}const _r=()=>new(Er("StoreHandler"))(Er("CuponomiaRestClient"),Er("AmazonRestClient"));function dr(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var fr=null;function hr(){if(null===fr){let e=dr();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),fr=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return fr}function gr(){let e=dr();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function pr(){let e=hr(),t=gr(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=dr();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var mr="__INTENTIONAL_UNDEFINED__";let br={};function Er(e){let t=pr();if(void 0===t[e])return function(e){switch(e){case"StoreHandler":return lr;case"CuponomiaRestClient":return tn;case"AmazonRestClient":return se}return}(e);var n=t[e];return n===mr?void 0:n}function yr(e,t){let n=pr();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){vr(e)}))}):(n[e]=void 0===t?mr:t,function(){vr(e)})}function vr(e){let t=pr();delete t[e],0==Object.keys(t).length&&delete gr()[hr]}function wr(e){let t=pr();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(br,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Er),e("__GetDependency__",Er),e("__Rewire__",yr),e("__set__",yr),e("__reset__",vr),e("__ResetDependency__",vr),e("__with__",wr)}();const{formatCashback:Rr,storeHasValidCashback:Or}=Gr("useCashback")(),Ir=!1;let Lr={async isFeatureDisabled(e){var t,n;return(null===(t=(await Gr("amazonClient").getExtensionConfig()).features)||void 0===t||null===(n=t[e])||void 0===n?void 0:n.disabled)??!1},checkBlacklist:async function(e){let t=await Gr("amazonClient").getCompetitors();Array.isArray(t)||(t=[]);const n=t.find((t=>{if(!(!!e.url||!!e.pendingUrl))return;const n=new URL(t.url),r=new URL(e.url||e.pendingUrl),a=n.hostname===r.hostname,o="/"===n.pathname||n.pathname===r.pathname,i=!!n.search,s=n.search===r.search;return a&&o&&(!i||i&&s)}))||{};return{...n,isBlacklist:!!Object.keys(n).length}},async checkInstalledExtensions(){if(await this.isFeatureDisabled("extension-checker"))return[];let e=await Gr("db").getCache("installed_extensions");if(!e){const t=await Gr("amazonClient").getExtensions();let n=[];console.groupCollapsed("Checking Extensions");for(let e of t)n.push(fetch(`chrome-extension://${e.id}`).then((()=>e.name)).catch((()=>null)));e=await Promise.allSettled(n).then((e=>e.map((e=>"fulfilled"===e.status&&e.value)).filter(Boolean))),console.groupEnd();const r=await this.getCache("installed-extensions");Gr("db").addCache("installed_extensions",e,r),chrome.alarms.create("installed_extensions",{delayInMinutes:this.minutesPerMilliseconds(r)})}return e},getGenericCoupons:async function(){return await Gr("amazonClient").getGenericCoupons()},getAllCookies:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=await this.getAllCuponomiaCookies(),n={...await this.ensureUserCookies(),...t};if(e){const t=/(&#|%26%23)(.*)/;e=e.replace(t,""),n.dvurl=e}return n},getTrackingData:async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const r=await this.getAllCookies(e),a=await this.checkInstalledExtensions(),o={...r,v:chrome.runtime.getManifest().version,market:"microsoft-store",isPinned:await this.checkIsPinned()};if(!("newTab"===e)){const t=Gr("getStoreHandlerInstance")(),r=n??await t.getStoreByUrl({currentUrl:e}),a=(null==r?void 0:r.slug)??n;a&&(o.slug=a)}return a.length&&(o.installedExtensions=a),t?this.objectToQueryString(o):o},sanitizeData:function(e,t){for(const n of Object.keys(e))null!=e[n]?t&&!t.includes(n)&&"string"==typeof e[n]&&(e[n]=e[n].replace(/[^A-zÀ-ú0-9 ]/g,""),e[n]=e[n].replace(/\s\s+/g," ")):delete e[n];return e},trackPageView:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"direct",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;let o=!!(await Gr("userHelper").getUserPreferences()).hasPreference("notifications"),i=await this.getTrackingData(t);await Gr("isFeatureEnabled")("send-cashback-displayed")&&Gr("storeHasValidCashback")(a)&&(i.cashbackDisplayed=Gr("formatCashback")(a.cashback));const s=await Gr("eventHelper").getMastersessionID();let c=this.objectToQueryString({...i,referrer:n,notification_opt_in:o,emsid:s,type:r});Gr("eventsClient").saveEventWith(c)},trackEvent:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=await this.getTrackingData(t);a[n]=r;const o=await Gr("eventHelper").getMastersessionID();let i=this.objectToQueryString({...a,emsid:o});Gr("eventsClient").saveEventWith(i)},trackNotification:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e=this.sanitizeData(e,["event_time_date","notification_landing_url"]);let n=await this.getTrackingData(t);const r=await Gr("eventHelper").getMastersessionID();let a=this.objectToQueryString({...n,...e,emsid:r});Gr("eventsClient").saveEventWith(a)},trackTutorial:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e=this.sanitizeData(e,["event_time_date","step","msid","uuid","sid"]);let n=await this.getTrackingData(t);const r=await Gr("eventHelper").getMastersessionID();let a=this.objectToQueryString({...n,...e,emsid:r});Gr("eventsClient").saveEventWith(a)},trackLookerEvent:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!Gr("development")||e&&e.evt&&""!==e.evt||console.error('You need to provide the name of the event in the "evt" key');const n={domain:new URL("https://www.cuponomia.com.br/").host},r=await this.getCookies(["msid","sid","uuid"],n),a={...e,msid:(null==r?void 0:r.msid)||null,uuid:(null==r?void 0:r.uuid)||null,sid:(null==r?void 0:r.sid)||null};null!=a&&a.event_time_date||(a.event_time_date=this.createFormattedDate());const o=this.sanitizeData(a,["event_time_date","msid","uuid","sid","position","slug","local","URL_product","URL_image","product_value","variation","time_start","time_end"]),i=await this.getTrackingData(t),s=await Gr("eventHelper").getMastersessionID(),c=this.objectToQueryString({...i,...o,emsid:s});Gr("development")&&(console.groupCollapsed(`Looker Send Event: ${e.evt} ${(null==a?void 0:a.action)||""}`),console.log(JSON.stringify(a)),console.groupEnd()),Gr("eventsClient").saveEventWith(c)},async trackingPageView(e){const[t,n,r,a]=await Promise.all([Gr("isFeatureDisabledInStore")("store-tracker",e.slug),Gr("db").getSession("store_page-view-ri"),Gr("db").getCache(`cashback_activated_${e.slug}`).then((e=>!!e)),this.getCache("pageview-checker")]);t||n||r||chrome.alarms.create(`store_page-view-ri_${e.slug}`,{delayInMinutes:this.minutesPerMilliseconds(a)})},async trackStore(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=Gr("getStoreHandlerInstance")(),r=await Gr("db").getCache(`cashback_activated_${e}`).then((e=>!!e));if(r)return;if(await Gr("db").getSession("store_page-view-ri"))return;const a=await n.getStoreBySlug({slug:e}),o=await this.getCache("store-tracker");Gr("db").addSession("store_page-view-ri",a.slug,o),chrome.alarms.create(`store_tracker_${e}`,{delayInMinutes:this.minutesPerMilliseconds(o)});if(!await Gr("loginHelper").getUser())return;const i={domain:new URL("https://www.cuponomia.com.br/").host},s=await this.getCookies(["msid","sid","uuid"],i),c={msid:(null==s?void 0:s.msid)||null,uuid:(null==s?void 0:s.uuid)||null,sid:(null==s?void 0:s.sid)||null},u=await this.getTrackingData(t),l=await this.checkIsPinned(),_=this.objectToQueryString({...c,...u}),d=[{Key:"slug",Value:a.slug},{Key:"storename",Value:a.name},{Key:"UID",Value:null==s?void 0:s.uuid},{Key:"cashback_at_moment",Value:Gr("formatCashback")(a.cashback)},{Key:"ispinned",Value:l}],f=await Gr("CuponomiaRestClient").sendStoreTracker(d,_);f.status>=200&&f.status<300&&this.trackLookerEvent({evt:"RI_STORE_PAGEVIEW",...d,...c},t)},createFormattedDate(){let e=new Date;const t=e=>`0${e}`.slice(-2);return`${e.getFullYear()}-${t(e.getMonth()+1)}-${t(e.getDate())} ${t(e.getHours())}:${t(e.getMinutes())}:${t(e.getSeconds())}`},getPercent:function(e){return`${Number(Math.round(100*e+"e+2")+"e-2").toString().replace(".",",")}%`},getTackedUrlForProduct:function(e,t,n){return`${e}${t=t.substring(1)}?redirect=${n}#cadastro-pedagio`},createTollPageLink:async function(e){const t=new URL("https://www.cuponomia.com.br/");return await Gr("userHelper").getUserInfo()||(t.hash="cadastro-pedagio"),t.pathname=e,t.href},handleCuponomiaUrl:async function(e){const t=/cuponomia\.com\.br(\/out\/|\/e\/out\/|\/ext\/out\/|\/ext\/stores\/|\/ext\/coupons\/|\/coupon\/show\/)([0-9]*)/i.test(e);return t&&await this.setCashbackInTollPage(),t},setCashbackInTollPage:async function(){if("undefined"==typeof document)return;!!(e=>{var t;const n=`; ${null===(t=document)||void 0===t?void 0:t.cookie}`;if(!n)return!1;const r=n.split(`; ${e}=`);return 2===r.length&&r.pop().split(";").shift()})("uuid")&&window&&(window.onload=async()=>{var e;const t=null===(e=document.querySelector("[data-store-slug]"))||void 0===e?void 0:e.dataset.storeSlug;t&&await Gr("db").addCache(`cashback_activated_toll_${t}`,{location},this.millisecondsPerHours(1))})},hasCashbackSetTollPage:async function(e){return!!await Gr("db").getCache(`cashback_activated_toll_${e}`)},setCashbackInCashbackPage:async function(e){await Gr("db").addCache(`cashback_activated_cashback_page_${e}`,{location},6e4)},hasCashbackSetCashbackPage:async function(e){return!!await Gr("db").getCache(`cashback_activated_cashback_page_${e}`)},isCuponomiaPage:function(e){return new URL(e).host.includes("cuponomia.com.br")},isCuponomiaToll:function(e){if(!e)return!1;const t=["/coupon/show/","/out/","/extensao/instalar","/clickout"].some((t=>e.includes(t)));return this.isCuponomiaPage(e)&&t},isGoogleSearchPage:function(e){return/google\.[\w|.]{2,}\/search/.test(e)},isBingSearchPage:function(e){return/bing\.[\w|.]{2,}\/search/.test(e)},isExtensionPages:function(e){return!!e&&-1!==e.indexOf("chrome://")},isOnCartPage:function(e,t){if(null==e||!e.extensionConfiguration)return!1;let n=e=>e.replace(/^(?:https?:\/\/)?(?:www\.)?/i,"");const r=n(t).split("?")[0],{carts:a=[]}=null==e?void 0:e.extensionConfiguration,o={keywords:new RegExp("carrinho.|sacola.|basket.|cart.|checkout.|buy.|/carrinho|/sacola|/basket|/cart|/buy|/webapp/wcs/stores|/a#cesta|/cart-show|/checkout|vendadpsp","i"),declaredPage(e){const t=n(e);return new RegExp(t,"i")}};return a.length?0!==a.filter((e=>o.declaredPage(e).test(n(r)))).length:o.keywords.test(t)},isOnPaymentPage:function(e,t){let n=e=>e.replace(/^(?:https?:\/\/)?(?:www\.)?/i,"");const r=n(t).split("?")[0],{payments:a=[]}=(null==e?void 0:e.extensionConfiguration)??{};if(null==a||!a.length)return!1;return 0!==a.filter((e=>(e=>{const t=n(e);return new RegExp(t,"i")})(e).test(n(r)))).length},isOnHomePage:function(e,t){if(null==e||!e.length)return!1;let n=new URL(t),r=`${(e=>e.replace(/^(?:www\.)?/i,""))(n.host)}${n.pathname.length>1?n.pathname:""}`;return e.includes(r)},isOnThankYouPage:async function(e,t){var n,r;if(!t||!e)return!1;const a=Gr("getStoreHandlerInstance")(),o=await this.getThankYouStore({slug:e});if(!o)return!1;const i=o.paths.some((e=>t.includes(e))),s=await a.getStoreBySlug({slug:o.slug});if(!(null==s||null===(n=s.extensionConfiguration)||void 0===n||null===(r=n.cashbackPage)||void 0===r?void 0:r.cookieToVerify))return i;const c=await this.verifyThankYouPageInCashbackPage({store:s,currentHost:t});return i&&c},verifyThankYouPageInCashbackPage:async function(e){var t;let{store:n,currentHost:r}=e;if(null==n||!n.cashbackPage)return!1;const{cookieToVerify:a}=null===(t=n.extensionConfiguration)||void 0===t?void 0:t.cashbackPage,o=await this.handleGetCookie({url:r,name:null==a?void 0:a.name});if(!o)return!1;return await this.hasValidCashbackPageCookie({cashbackPage:n.extensionConfiguration.cashbackPage,cookies:[o],currentHost:r})},isOnBlacklistPage:function(e,t){if(null==e||!e.length)return!1;for(let n of e)if(t.includes(n))return!0;return!1},isOnCouponPage:async function(e,t){let n=(await Gr("amazonClient").getCouponTester()).find((t=>t.slug===e));return!(!n||n.disabled)&&(null==n?void 0:n.paths.some((e=>{var r;return!!t.includes(e)||!(null==n||null===(r=n.regexpPaths)||void 0===r||!r.length)&&n.regexpPaths.some((e=>new RegExp(e).test(t)))})))},isOnCashbackPage:async function(e,t){var n,r;if(!e||!e.hosts&&!e.unreferencedRoutes)return!1;let a=!1;if(null!==(n=e.cookieToVerify)&&void 0!==n&&n.name&&null!==(r=e.cookieToVerify)&&void 0!==r&&r.value){var o,i;const n=e.cookieToVerify&&(null===(o=e.unreferencedRoutes)||void 0===o?void 0:o.map((t=>{var n;return this.handleGetCookie({url:t,name:null===(n=e.cookieToVerify)||void 0===n?void 0:n.name})})))||[],r=(await Promise.all(n)).some((t=>{var n;return(null==t?void 0:t.value)===(null===(n=e.cookieToVerify)||void 0===n?void 0:n.value)})),s=null===(i=e.unreferencedRoutes)||void 0===i?void 0:i.some((e=>{const n=this.removeProtocolsFromUrl(t),r=this.removeProtocolsFromUrl(e);return n.includes(r)}));a=r&&s}return e.hosts.some((e=>new RegExp(e).test(t)))||a},isUrlOnList:(e,t)=>!!Array.isArray(e)&&e.some((e=>t.includes(e))),removeStoresFromRememberList:async function(e){if(!e||!this.isLastStoreTab(e))return;let t=await this.getSlug(e.url);Gr("db").get("remember",(e=>{if(!e.exist)return;let n=e.data.remember,r=[];for(let a in e.data.remember)r=e.data.remember[a],Array.isArray(r)&&r.includes(t)&&(r.splice(r.indexOf(t),1),n[a]=r);Gr("db").add("remember",n)}))},showModalErrorCashback:async function(e,t){this.cancelCashback(e,t,{data:{category:"EARLY_ACTIVATION_CASHBACK",title:"Cashback não ativado",description:"Ocorreu um erro e não conseguimos ativar o seu cashback, tente novamente.",featureName:"EARLY_ACTIVATION_CASHBACK",featureClick:"EARLY_ACTIVATION_CASHBACK",button:{trackingAction:"click",activeCashback:!0,text:"Ativar cashback",value:"EARLY_ACTIVATION_CASHBACK"},tracking:{categoryEvent:"EARLY_ACTIVATION_CASHBACK",categoryBI:"EARLY_ACTIVATION_CASHBACK"}}})},mountTabConfig:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{targetUrl:null,slug:null,featureClick:null,user:null,activeCashback:!1,redirectToNewTab:!1,redirectPath:""};const{targetUrl:t,slug:n,featureClick:r,user:a,activeCashback:o,redirectToNewTab:i,redirectPath:s}=e,c=await Gr("isFeatureEnabledInStore")("redirect-to-new-tab-on-the-same-page",n);let u="";if(await Gr("isFeatureEnabled")("send-cashback-displayed")){const{store:e}=await Gr("CuponomiaRestClient").getDataStore(n);Gr("storeHasValidCashback")(e)&&(u=`&cashbackDisplayed=${encodeURIComponent(Gr("formatCashback")(e.cashback))}`)}return{active:i||!a&&o,pinned:!i&&(!!a||!o),url:`${t}?emsid=${await Gr("eventHelper").getMastersessionID()}&feature_click=${r}${u}${a||!o?i?"":"&view=false":"#cadastro-pedagio"}${s&&c?`&redirect=${encodeURIComponent(s)}`:""}`}},activateCashbackFromTargetUrl:async function(e,t,n,r,a){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"";const c=await this.mountTabConfig({targetUrl:e,slug:t,featureClick:n,user:a,activeCashback:o,redirectToNewTab:i,redirectPath:s}),u=await Gr("isFeatureEnabledInStore")("early-activation-cashback",t),l=await Gr("getFeatureConfig")("early-activation-cashback"),{activationWaitingTime:_}=l;try{const e=this.createFormattedDate();return new Promise((async n=>{var s;const l=await Gr("tabHelper").createTabAsync(c),d=setTimeout((async()=>{u&&(this.trackLookerEvent({evt:"EARLY_ACTIVATION_CASHBACK",action:"activation",slug:t}),await this.setActivatedCashback({slug:t,user:a,tab:r},n),n({success:!0}))}),_),f=await Gr("amazonClient").getExtensionConfig(),h=null==f||null===(s=f.earlyCashbackActivation)||void 0===s?void 0:s.delayToWaitForCashbackActivationInMilliseconds,g=setTimeout((async()=>{if(u){var a;this.trackLookerEvent({evt:"EARLY_ACTIVATION_CASHBACK",action:"time_out",slug:t});const{store:e}=await Gr("CuponomiaRestClient").getDataStore(t);if(null!=e&&null!==(a=e.extensionConfiguration)&&void 0!==a&&a.siteUrl){var o;const t=new URL(null==e||null===(o=e.extensionConfiguration)||void 0===o?void 0:o.siteUrl);this.showModalErrorCashback(t.host,e)}}Gr("tabHelper").remove(l.id),Gr("tabHelper").sendMessageTab(r.id,{request:"hasActivatedTabClosed"}),this.trackLookerEvent({evt:"TIME_OF_ACTIVATION",action:"time_out",slug:t,time_start:e,time_end:this.createFormattedDate()}),n({success:!1})}),h);let p=async(s,c,_)=>{if(!a&&o){if(!await Gr("userHelper").getUserInfo())return}const f=Gr("getStoreHandlerInstance")(),h=await f.getStoreByUrl({currentUrl:_.url}),m=_.id===l.id,b="complete"===c.status;if(m&&b&&h){if(Gr("tabHelper").setTitleFaviconLoadingTab(l.id),clearTimeout(d),clearTimeout(g),o)if(i)this.updateAllStoresTabsWithoutRemoveActivated(t,a,_,r,l,n);else{const{delayTimeBeforeCloseTab:o}=await Gr("amazonClient").getExtensionConfig();setTimeout((async()=>{u&&this.trackLookerEvent({evt:"EARLY_ACTIVATION_CASHBACK",action:"complete_success",slug:t}),await this.updateAllStoresTabs(t,a,_,r,l,n),this.trackLookerEvent({evt:"TIME_OF_ACTIVATION",action:"success",slug:t,time_start:e,time_end:this.createFormattedDate()})}),o)}else Gr("tabHelper").remove(l.id),Gr("tabHelper").sendMessageTab(r.id,{request:"hasActivatedTabClosed"}),this.trackLookerEvent({evt:"TIME_OF_ACTIVATION",action:"success",slug:t,time_start:e,time_end:this.createFormattedDate()}),chrome.tabs.onUpdated.removeListener(p),n({success:!0});chrome.tabs.onUpdated.removeListener(p)}};chrome.tabs.onUpdated.addListener(p)}))}catch(e){console.warn(e),u&&(Gr("db").remove(`cashback_activated_${t}`),this.trackLookerEvent({evt:"EARLY_ACTIVATION_CASHBACK",action:"complete_error",slug:t}))}},getAllCuponomiaCookies:function(){var e=[];let t={domain:new URL("https://www.cuponomia.com.br/").host};return new Promise(((n,r)=>{chrome.cookies.getAll(t,(t=>{t.forEach((t=>{this.isJsonString(t.value)||(e[t.name]=t.value)})),n(e)}))}))},currentCampaignData:async function(){return await new Promise((async(e,t)=>{var n;const r=await Gr("db").getSession("referral_campaign"),a=(new Date).getTime(),o=new Date(null==r||null===(n=r.value)||void 0===n?void 0:n.endDate).getTime();if((null==r?void 0:r.expiresAt)>a&&o>a)return e(r.value);try{const t=await Gr("CuponomiaRestClient").getDataCampaign();return await Gr("db").addSession("referral_campaign",t,await this.getCache("referral-campaign")),e(t)}catch(e){0}}))},idGenerator:function(){const e="abcdefghijklmnopqrstuvwxyz0123456789";return Array.from({length:20},(()=>e[Math.floor(36*Math.random())])).join("")},ensureUserCookies:async function(){return{edid:await this.findOrCreate("edid"),euid:await this.findOrCreate("euid")}},findOrCreate:function(e){const t=this.idGenerator().length,n={edid:{get:(e,t)=>Gr("db").get(e,t),add:e=>Gr("db").add("edid",e,(e=>e.data))},euid:{get:(e,t)=>Gr("db").getSync(e,t),add:e=>Gr("db").addSync("euid",e,(e=>e.data))}};return new Promise((r=>n[e].get(e,(async a=>{let o=a.data&&a.data[e]||null;if(!o||o.length!==t){let t=this.idGenerator();return await n[e].add(t),r(t)}r(o)}))))},objectToQueryString:function(e){return Object.keys(e).map((t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t]))).join("&")},removeActivatedCashbacks:async function(){let e=await Gr("db").getAll();for(let t of e)t.startsWith("cashback_activated_")&&Gr("db").remove(t)},removeActivatedCashbackByTab:async function(e){if(!e||!this.isLastStoreTab(e))return;let t=n.g.clickOutTabsId.indexOf(e.id);if(t>-1)return this.removeArrayElementByIndex(n.g.clickOutTabsId,t);let r=await this.getSlug(e.url);Gr("db").remove(`cashback_activated_${r}`)},removeArrayElementByIndex:function(e,t){return e.splice(t,1)},isLastStoreTab:function(e){let t=0;if(null==e)return!1;for(let r in n.g.openedTabs)n.g.openedTabs[r].slug===e.slug&&t++;return 1===t},isLastActitiveCashbackStoreTab:async function(){const e=Gr("getStoreHandlerInstance")(),t=await chrome.storage.local.get().then((e=>Object.keys(e).filter((e=>e.startsWith("cashback_activated"))).map((t=>e[t].value.slug))));for(let n of t){const[t,r]=await Promise.all([e.getStoreBySlug({slug:n}),e.getHostsBySlug({slug:n})]);if(!t)continue;const a=(null==r?void 0:r.map((e=>`*://*.${e}/*`)))??[];if(!(await chrome.tabs.query({url:a})).length)return t.slug}return!1},isJsonString:function(e){try{JSON.parse(e)}catch(e){return!1}return!0},disableExtension:function(e){chrome.action.setIcon({path:"assets/img/icons/idle-icon.png",tabId:e})},enableStaticIcon:function(e){chrome.action.setIcon({path:"assets/img/icons/main-icon.png",tabId:e})},minutesPerMilliseconds:function(e){return e/6e4},millisecondsPerMinutes:function(e){return 6e4*e},millisecondsPerHours:function(e){return 60*e*6e4},millisecondsPerDays:function(e){return 24*e*60*6e4},millisecondsPerMonths:function(e){return 30*e*24*60*6e4},hasStoreBar:async function(){let e=await Gr("tabHelper").getCurrentTabAsync();return!(null==e||!e.id)&&await chrome.tabs.sendMessage(e.id,{text:"has_store_bar"})},getEdid:async function(){return await new Promise((e=>Gr("db").get("edid",(t=>{var n;return e(null===(n=t.data)||void 0===n?void 0:n.edid)}))))},getCurrentUrlFromRequest:function(e){var t,n,r,a,o,i,s,c;return null!==(t=e.body)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&n.url?e.body.data.url:null!==(r=e.body)&&void 0!==r&&null!==(a=r.data)&&void 0!==a&&null!==(o=a.location)&&void 0!==o&&o.href?e.body.data.location.href:null!==(i=e.sender)&&void 0!==i&&null!==(s=i.tab)&&void 0!==s&&s.url?e.sender.tab.url:null!==(c=e.sender)&&void 0!==c&&c.url?e.sender.url:void 0},getCache:async function(e){const t=await Gr("amazonClient").getExtensionConfig();if(null==t||!t.cacheTimers||!(e in t.cacheTimers))return 36e5;return this.millisecondsPerMinutes(t.cacheTimers[e])},getCookies:async function(e,t){return new Promise(((n,r)=>{chrome.cookies.getAll(t).then((t=>{const r=t.filter((t=>e.includes(t.name))).reduce(((e,t)=>(e[t.name]=t.value,e)),{});n(r)}))}))},checkIsPinned:async function(){return(await chrome.action.getUserSettings()).isOnToolbar},cancelCashback:async function(e,t,n){e&&t&&Gr("tabHelper").executeInAllTabs({url:[`*://${e}/*`,`*://www.${e}/*`]},(e=>{Gr("tabHelper").sendMessage(e.id,"openModalAlertCashbackCancelled",n),chrome.action.setIcon({path:"assets/img/icons/main-icon.png",tabId:e.id})}))},refreshStorePages:async function(){Gr("tabHelper").query({},(async e=>{const t=Gr("getStoreHandlerInstance")();let n=(await Promise.all(e.map((async e=>await t.getStoreByUrl({currentUrl:e.url})&&e)))).filter((e=>null!==e));for(let e of n)Gr("tabHelper").reloadTab(e.id);let r=e.filter((e=>!n.includes(e))).concat(n.filter((t=>!e.includes(t))));for(let e of r)this.disableExtension(e.id)}))},setActivatedCashback:async function(e,t){var n;const r=Gr("getStoreHandlerInstance")();let[a,o,i]=await Promise.all([this.getCache("cashback-activated"),r.getStoreBySlug({slug:e.slug}),Gr("isFeatureEnabled")("expired-cashback")]);var s;Number.isFinite(null==o||null===(n=o.extensionConfiguration)||void 0===n?void 0:n.expiredCashbackTimeInMinutes)&&(a=this.millisecondsPerMinutes(null==o||null===(s=o.extensionConfiguration)||void 0===s?void 0:s.expiredCashbackTimeInMinutes));const c=(a+3e3)/6e4,u=new URL(e.tab.url).hostname;Gr("db").remove("competitor_accessed"),Gr("db").remove(`cashback_activated_toll_${e.slug}`);const l={slug:e.slug,user:e.user,blockTabs:(null==e?void 0:e.blockTabs)??[]};Gr("db").addCache(`cashback_activated_${e.slug}`,l,a).then((e=>{var n;return e.status?(!i||null!=o&&null!==(n=o.extensionConfiguration)&&void 0!==n&&n.disableExpiredCashback||chrome.alarms.create(`cashback_expired_${u}`,{delayInMinutes:c}),t({success:!0,message:"Cashback ativado!"})):t({success:!1,message:"O cashback não foi ativado!"})}))},updateAllStoresTabsWithoutRemoveActivated:async function(e,t,n,r,a,o){this.setActivatedCashback({slug:e,user:t,tab:n,blockTabs:[r.id]},(async()=>{const e=new(Gr("ForegroundHelper"));return await e.waitForReady({tabId:a.id}),Gr("tabHelper").sendMessageTab(a.id,{request:"openModalCashbackInfo",data:{title:"O seu cashback está aqui!",description:"Para garantir seu cashback, finalize sua compra <strong>apenas nesta página.</strong>",actionCopy:"Ok, entendi!",origin:"redirectToNewTab",illustrationName:"woman-cashback-success.svg",activeCashback:!1,tracking:null,featureClick:"redirect_to_new_tab",position:"topRight"}}),Gr("tabHelper").sendMessageTab(r.id,{request:"hasActivatedTabClosed"}),o({success:!0})}))},updateAllStoresTabs:async function(e,t,n,r,a,o){if(!await Gr("userHelper").getUserInfo())return Gr("tabHelper").remove(a.id),Gr("tabHelper").sendMessageTab(r.id,{request:"hasActivatedTabClosed"}),o({success:!1});this.setActivatedCashback({slug:e,user:t,tab:n},(async()=>{const t=Gr("getStoreHandlerInstance")();let n=(await t.getHostsBySlug({slug:e}))[0];r&&(n=new URL(r.url).hostname),Gr("tabHelper").remove(a.id),Gr("tabHelper").sendMessageTab(r.id,{request:"hasActivatedTabClosed"}),Gr("tabHelper").executeInAllTabs({url:`*://*.${n}/*`},(e=>{(null==r?void 0:r.id)!==e.id&&Gr("tabHelper").sendMessageTab(e.id,{request:"spaUpdated"})})),o({success:!0})}))},async showPinTutorial(e,t,n){e||(e=await Gr("tabHelper").getCurrentTabAsync().then((e=>e.id))),Gr("tabHelper").executeScriptFile(e,"pin_tutorial.js",(()=>chrome.tabs.sendMessage(e,{tutorial:!0,shouldShowCloseButton:t,eventOrigin:n})))},getWarningByURL:async e=>(await Gr("amazonClient").getWarnings()).find((t=>new RegExp(t.url).test(e))),getWarningById:async e=>(await Gr("amazonClient").getWarnings()).find((t=>t.id===e)),setStoreHasInteraction(e){if(!e)return;const t={...e.value,hasInteracted:!0},n=`cache_${t.slug}`,r=e.timeToExpire;Gr("db").set(n,t,r)},setStoreProp(e,t){if(!e)return;const n={...e.value,[t.prop]:t.value},r=`cache_${n.slug}`,a=e.timeToExpire;Gr("db").set(r,n,a)},setStoreCustomActivedDescription(e,t){if(!e)return;const n={...e.value,customActivedDescription:t},r=`cache_${n.slug}`,a=e.timeToExpire;Gr("db").set(r,n,a)},filterStoresbyCashback:e=>e.filter((e=>Gr("storeHasValidCashback")(e))),async setStoreHasVisited(e){if(!e)return;const t=`cache_${e}`,n=await Gr("db").getValid(t),r=n.timeToExpire,a={...n.value,hasVisited:!0,lastAccess:Date.now()};Gr("db").set(t,a,r)},removeProtocolsFromUrl:e=>e.replace(/^(?:https?:\/\/)?(?:www\.)?/i,""),handleGetCookie:async e=>e&&e.name&&e.url?new Promise((t=>{chrome.cookies.get(e,(e=>t(e)))})):null,async hasValidCashbackPageCookie(e){var t,n,r;let{cashbackPage:a,currentHost:o,cookies:i}=e;if(null==a||null===(t=a.cookieToVerify)||void 0===t||!t.name||null==a||null===(n=a.cookieToVerify)||void 0===n||!n.value)return!1;const s=i.some((e=>{var t;return(null==e?void 0:e.value)===(null===(t=a.cookieToVerify)||void 0===t?void 0:t.value)})),c=null===(r=a.unreferencedRoutes)||void 0===r?void 0:r.some((e=>{const t=this.removeProtocolsFromUrl(o),n=this.removeProtocolsFromUrl(e);return t.includes(n)}));return s&&c},async getThankYouStore(e){let{slug:t}=e;if(!t)return null;const n=(await Gr("amazonClient").getThankYouStores()).find((e=>e.slug===t));return n??null},async isCashbackPageCompetitor(e){if(["cashbackPage","currentUrl","tab"].some((t=>!e[t])))return!1;const[t,n]=await Promise.all([this.isOnCashbackPage(e.cashbackPage,e.currentUrl),this.checkBlacklist(e.tab)]),r=null==n?void 0:n.isBlacklist,a=e.cashbackPage.unreferencedRoutes.some((t=>e.currentUrl.includes(t)));return e.cashbackPage&&!t&&(r||a)},getSetting:async e=>(await Gr("amazonClient").getExtensionConfig())[e],generateHash(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;return Math.random().toString(36).substring(2,e)},async waitDelay(e){await new Promise((t=>setTimeout((()=>t()),e??0)))},async getCompetitorsOverlapTime(){const[e,t]=await Promise.all([Gr("db").getCache("installed_extensions"),Gr("getFeatureConfig")("competitors-toasts-overlap")]);if(!e||!t||!t.enabled)return 0;return e.some((e=>t.competitors.includes(e)))&&Number(t.waitTimeInMilliseconds)||0},async getDelayTimeAfterCreateTab(){const{delayTimeAfterCreateTab:e=0}=await Gr("amazonClient").getExtensionConfig(),t=await this.getCompetitorsOverlapTime();return Number(t)+Number(e)},async getTimeToTryCompetitorsTopVisibility(){const e=await Gr("getFeatureConfig")("competitors-toasts-overlap");return e&&e.enabled?e.timeToTryTopVisibilityInMilliseconds??0:0},async hasCompetitorsToOverlapInstalled(){const[e,t]=await Promise.all([Gr("db").getCache("installed_extensions"),Gr("getFeatureConfig")("competitors-toasts-overlap")]);if(!e||!t||!t.enabled)return!1;return e.some((e=>t.competitors.includes(e)))},getRootWrapperNameHash:async()=>new Promise((e=>{Gr("db").get("root-wrapper-name-hash",(t=>{var n;if(!t.exist)return null;e((null===(n=t.data)||void 0===n?void 0:n["root-wrapper-name-hash"])??null)}))})),async hasCompetitorsToBlockCashbackActivation(){const[e,t]=await Promise.all([Gr("db").getCache("installed_extensions"),Gr("getFeatureConfig")("cancel-cashback-activation-adblocker")]);if(!e||!t||!t.enabled)return!1;return e.some((e=>t.competitors.includes(e)))},sendBrowserIconEvent(){this.trackLookerEvent({evt:"BROWSER_ICON",action:"extension_not_loaded"})}};const Tr=Lr;function Sr(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var Cr=null;function kr(){if(null===Cr){let e=Sr();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),Cr=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return Cr}function $r(){let e=Sr();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Ar(){let e=kr(),t=$r(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=Sr();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Dr="__INTENTIONAL_UNDEFINED__";let jr={};function Gr(e){let t=Ar();if(void 0===t[e])return function(e){switch(e){case"useCashback":return Je;case"amazonClient":return se;case"db":return r;case"getStoreHandlerInstance":return _r;case"userHelper":return mn;case"isFeatureEnabled":return ut;case"storeHasValidCashback":return Or;case"formatCashback":return Rr;case"eventHelper":return $n;case"eventsClient":return Re;case"development":return Ir;case"isFeatureDisabledInStore":return _t;case"loginHelper":return Be;case"CuponomiaRestClient":return tn;case"isFeatureEnabledInStore":return lt;case"getFeatureConfig":return dt;case"tabHelper":return Wr;case"ForegroundHelper":return qn}return}(e);var n=t[e];return n===Dr?void 0:n}function Nr(e,t){let n=Ar();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Pr(e)}))}):(n[e]=void 0===t?Dr:t,function(){Pr(e)})}function Pr(e){let t=Ar();delete t[e],0==Object.keys(t).length&&delete $r()[kr]}function Br(e){let t=Ar();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(jr,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Gr),e("__GetDependency__",Gr),e("__Rewire__",Nr),e("__set__",Nr),e("__reset__",Pr),e("__ResetDependency__",Pr),e("__with__",Br)}();function Ur(e,t){Object.defineProperty(Lr,e,{value:t,enumerable:!1,configurable:!0})}Object.isExtensible(Lr)&&(Ur("__get__",Gr),Ur("__GetDependency__",Gr),Ur("__Rewire__",Nr),Ur("__set__",Nr),Ur("__reset__",Pr),Ur("__ResetDependency__",Pr),Ur("__with__",Br),Ur("__RewireAPI__",jr));const xr=!1;let Mr={query:function(e,t){chrome.tabs.query(e,(e=>this.callbackHelper("query",e,t)))},queryAsync:function(e){return new Promise(((t,n)=>{this.query(e,(e=>{void 0!==e?t(e):n(new Error("No tabs found or an error occurred"))}))}))},get:function(e,t){chrome.tabs.get(e,(e=>this.callbackHelper("get",e,t)))},getAsync:function(e){return new Promise((t=>this.get(e,t)))},executeInAllTabs:function(e,t,n){this.query(e,(function(e){e.forEach((e=>{t(e)})),void 0!==n&&n()}))},sendMessageTabAsync:function(e,t){return new Promise(((n,r)=>{chrome.tabs.sendMessage(e,t,(e=>{const t=chrome.runtime.lastError;void 0!==t?(Kr("development")&&console.log(t.message),r(new Error(t.message))):n(e)}))}))},sendMessageTab:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n||(n=()=>{const e=chrome.runtime.lastError;void 0!==e&&Kr("development")&&console.log(e.message)}),chrome.tabs.sendMessage(e,t,n)},sendMessage:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r.request=t,r.response=n,this.sendMessageTab(e,r)},createTabAsync:function(e){return new Promise(((t,n)=>{chrome.tabs.create(e,(e=>{chrome.runtime.lastError?n(new Error(chrome.runtime.lastError)):t(e)}))}))},createTab:function(e,t,n){chrome.tabs.create({url:e,active:t},n)},executeScriptFile:function(e,t,n){chrome.scripting.executeScript({target:{tabId:e},files:[t]},(e=>this.callbackHelper("executeScriptFile",e,n)))},executeScript:function(e,t,n,r){chrome.scripting.executeScript({target:{tabId:e},func:t,args:n},(e=>this.callbackHelper("executeScript",e,r)))},reloadTab:function(e){chrome.tabs.reload(e)},isTabUrlAllowed:function(e){return!(!e||!e.url||e.url.startsWith("chrome://")||e.url.startsWith("chrome-extension://"))},executeContentScript:async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;chrome.tabs.get(e,(async a=>{this.isTabUrlAllowed(a)?chrome.scripting.executeScript({target:{tabId:e},files:[`content-scripts/${t}`]},(e=>{this.callbackHelper("executeContentScript",e,n)})):r>0?setTimeout((()=>{this.executeContentScript(e,t,n,r-1)}),2e3):this.callbackHelper("executeContentScript",null,n,new Error("URL not allowed"))}))},insertCSS:function(e,t,n){chrome.scripting.insertCSS({target:{tabId:e},files:[t]},(e=>this.callbackHelper("insertCSS",e,n)))},setTitleFaviconLoadingTab:function(e){let t=chrome.runtime.getURL(chrome.runtime.getManifest().icons[128]);this.sendMessageTab(e,{text:"set_favicon_loading_tab",data:{favicon:t}})},onActivated:function(e){chrome.tabs.onActivated.addListener(e)},onCreated:function(e){chrome.tabs.onCreated.addListener(e)},onUpdated:function(e){chrome.tabs.onUpdated.addListener(e)},onRemoved:function(e){chrome.tabs.onRemoved.addListener(e)},isTabLoaded:function(e){return e&&"complete"===e.status},getCurrentTab:function(e){chrome.tabs.query({currentWindow:!0,active:!0},(t=>this.callbackHelper("getCurrentTab",t[0],e)))},getCurrentTabAsync:function(){return new Promise((e=>this.getCurrentTab(e)))},remove:function(e,t){chrome.tabs.remove(e,t)},waitPageCompleteLoaded:async function(e){if(this.isTabLoaded(e))return new Promise((e=>e()));const t=await Kr("generalHelper").getSetting("timeLimitToAwaitTabLoad");return new Promise((n=>{const r=setTimeout((()=>{n(),chrome.tabs.onUpdated.removeListener(a)}),t),a=(t,o,i)=>{e.id==t&&this.isTabLoaded(i)&&(clearTimeout(r),chrome.tabs.onUpdated.removeListener(a),n())};chrome.tabs.onUpdated.addListener(a)}))},callbackHelper(e,t,n){let r=chrome.runtime.lastError;void 0!==r?Kr("development")&&console.log(`${e}: ${r.message}`):n&&n(t)}};const Wr=Mr;function Hr(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var Fr=null;function Yr(){if(null===Fr){let e=Hr();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),Fr=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return Fr}function qr(){let e=Hr();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Xr(){let e=Yr(),t=qr(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=Hr();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Vr="__INTENTIONAL_UNDEFINED__";let zr={};function Kr(e){let t=Xr();if(void 0===t[e])return function(e){switch(e){case"development":return xr;case"generalHelper":return Tr}return}(e);var n=t[e];return n===Vr?void 0:n}function Jr(e,t){let n=Xr();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Qr(e)}))}):(n[e]=void 0===t?Vr:t,function(){Qr(e)})}function Qr(e){let t=Xr();delete t[e],0==Object.keys(t).length&&delete qr()[Yr]}function Zr(e){let t=Xr();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(zr,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Kr),e("__GetDependency__",Kr),e("__Rewire__",Jr),e("__set__",Jr),e("__reset__",Qr),e("__ResetDependency__",Qr),e("__with__",Zr)}();function ea(e,t){Object.defineProperty(Mr,e,{value:t,enumerable:!1,configurable:!0})}Object.isExtensible(Mr)&&(ea("__get__",Kr),ea("__GetDependency__",Kr),ea("__Rewire__",Jr),ea("__set__",Jr),ea("__reset__",Qr),ea("__ResetDependency__",Qr),ea("__with__",Zr),ea("__RewireAPI__",zr));let ta={injectContentScripts:async function(e,t,n){if(!e)return;e=[].concat(e);let r=[];for(let a of e){const e=`${a.includes("/")?"stores":t}/${a}`;if(a.includes("similar-products")){if(!(await da("userHelper").getUserPreferences()).hasPreference("similar-products"))continue}r.push(da("tabHelper").executeContentScript(n,e))}await Promise.all(r)}};function na(e){if(!e)return!1;const t=window.getComputedStyle(e);return!("none"===t.display||"hidden"===t.visibility||null===e.offsetParent)}async function ra(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e4;return new Promise((n=>{const r=setTimeout((()=>{a.disconnect(),n()}),t);if(document.querySelector(e))return clearTimeout(r),n(document.querySelector(e));const a=new MutationObserver((()=>{if(document.querySelector(e))return clearTimeout(r),a.disconnect(),n(document.querySelector(e))}));a.observe(document.body,{childList:!0,subtree:!0})}))}async function aa(e){const t=await da("generalHelper").getRootWrapperNameHash();await da("waitForHTMLElement")(`#${t}`,null==e?void 0:e.waitMaxTimeInMs)}function oa(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var ia=null;function sa(){if(null===ia){let e=oa();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),ia=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return ia}function ca(){let e=oa();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function ua(){let e=sa(),t=ca(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=oa();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var la="__INTENTIONAL_UNDEFINED__";let _a={};function da(e){let t=ua();if(void 0===t[e])return function(e){switch(e){case"isElementVisible":return na;case"generalHelper":return Tr;case"waitForHTMLElement":return ra;case"userHelper":return mn;case"tabHelper":return Wr}return}(e);var n=t[e];return n===la?void 0:n}function fa(e,t){let n=ua();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){ha(e)}))}):(n[e]=void 0===t?la:t,function(){ha(e)})}function ha(e){let t=ua();delete t[e],0==Object.keys(t).length&&delete ca()[sa]}function ga(e){let t=ua();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(_a,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",da),e("__GetDependency__",da),e("__Rewire__",fa),e("__set__",fa),e("__reset__",ha),e("__ResetDependency__",ha),e("__with__",ga)}();function pa(e,t){Object.defineProperty(ta,e,{value:t,enumerable:!1,configurable:!0})}Object.isExtensible(ta)&&(pa("__get__",da),pa("__GetDependency__",da),pa("__Rewire__",fa),pa("__set__",fa),pa("__reset__",ha),pa("__ResetDependency__",ha),pa("__with__",ga),pa("__RewireAPI__",_a));class ma{async getStoreBySlug(e){return new Promise((t=>{chrome.runtime.sendMessage({action:"getStoreBySlug",data:{slug:e}},(e=>{t(e)}))}))}async getHostsBySlug(e){return new Promise((t=>{chrome.runtime.sendMessage({action:"getHostsBySlug",data:{slug:e}},(e=>{t(e)}))}))}async getStoreByName(e){return new Promise((t=>{chrome.runtime.sendMessage({action:"getStoreByName",data:{name:e}},(e=>{t(e)}))}))}async getAllSlugs(){return new Promise((e=>{chrome.runtime.sendMessage({action:"getAllSlugs"},(t=>{e(t)}))}))}async getStoreByUrl(e){return new Promise((t=>{chrome.runtime.sendMessage({action:"getStoreByUrl",data:{url:e}},(e=>{t(e)}))}))}}const ba=new(xa("StoreHelper")),Ea=1280,ya=window.innerWidth>=xa("MINIMUM_SCREEN_WIDTH");function va(e,t){var n,r,a,o,i;if(!e)return null;const s=(null===(n=e.querySelector(t.productImage))||void 0===n?void 0:n.getAttribute("src"))||null,c=null===(r=e.querySelector(t.productLink))||void 0===r?void 0:r.getAttribute("href"),u=null===(a=e.querySelector(t.productName))||void 0===a?void 0:a.innerText,l=null===(o=e.querySelector(t.productPrice))||void 0===o||null===(i=o.firstChild)||void 0===i?void 0:i.textContent,_=e.getAttribute("data-dtld");if(!c||!u||!l)return null;return{name:u,link:c,image:s,price:l,storeNameGoogle:_,store:null,priceNumber:xa("getPrice")(l)}}const wa=document.querySelector("html").getAttribute("lang"),Ra=["pt-PT","pt-BR","en-BR","en"],Oa=new Date,Ia="ge",La="google",Ta=e=>{const t=/(\d{1,3}\.?,?)+/,n=/#([^#]*)$/,r=/.([^.]*)$/;if(null==e||!e.includes("R$"))return null;let a=e.match(t)[0];return a=a.replaceAll(",","."),(a.match(/\./g)||[]).length>1&&(a=a.replace(r,"#$1"),a=a.replaceAll(".",""),a=a.replace(n,".$1")),parseFloat(a)},Sa=e=>new URLSearchParams(new URL(`https://www.google.com${e}`).searchParams).get("url")||e.split("/url?url=")[1];async function Ca(){var e,t,n,r,a,o,i,s;const[c,u]=await Promise.all([xa("getSimilarProductsConfig")(xa("pageName")),xa("getFeatureConfig")("coupon-tag")]);if(!c)return!1;const{threshold:l,disabled:_=!1,selectors:d,handleEventViewGoogleShopping:f,googleStoreBlacklist:h=[],googleStoreList:g={},productLimit:p=6,eventsLimit:m=6,storesSimilar:b=[],enabledFallback:E=!1}=c;let y=document.querySelectorAll(d.productList)??null;const v=!!document.querySelector(d.shoppingTab)??!1;y&&0!==(null===(e=y)||void 0===e?void 0:e.length)||(y=document.querySelectorAll(d.resultsElements));if(!document.querySelector(d.shoppingEnabled))return!1;const w=(null===(t=document.querySelector(d.search))||void 0===t?void 0:t.value)??"",R=(null===(n=document.querySelector(d.searchSuggestion))||void 0===n?void 0:n.textContent)??null,O=(null===(r=document.querySelector(d.searchOriginal))||void 0===r?void 0:r.textContent)??w,I=document.querySelector(d.resultsElements),L={price:xa("getPrice")((null===(a=I.querySelector(d.productPrice))||void 0===a||null===(o=a.firstChild)||void 0===o?void 0:o.textContent)||(null===(i=I.querySelector(d.productPrice))||void 0===i?void 0:i.textContent)),name:(null===(s=I.querySelector(d.productName))||void 0===s?void 0:s.textContent)||null};if(L.name&&L.price){const e=[];for(const t of y){const n=xa("getSponsorsDataFromElement")(t,d);if(n){var T;if(n.storeNameGoogle in g)n.store=g[n.storeNameGoogle];else{n.link.includes("/url?url=")&&(n.link=xa("getUrlFromGoogleQueryParams")(n.link));let e=await xa("storeHelper").getStoreByUrl(n.link);n.store=null==e?void 0:e.slug}const[t,r]=await Promise.all([xa("storeHelper").getStoreBySlug(n.store),xa("storeHelper").getHostsBySlug(n.store)]);if(null!=t&&null!==(T=t.extensionConfiguration)&&void 0!==T&&T.useCustomLinkRedirect&&n.link&&(null==r?void 0:r.length)>0){var S;let e=new URL(n.link),a=`${(null==t||null===(S=t.extensionConfiguration)||void 0===S?void 0:S.baseURLtoRedirect)??`https://www.${r[0]}`}${e.pathname}${e.search}&n=cuponomia${e.hash}`;n.link=a}n.numberOfCoupons=(null==t?void 0:t.numberOfCoupons)??0,e.push(n)}}if(e.length>0){await xa("waitForRootWrapperElement")();const t=!1,n={q:[L],origin:xa("origin"),search:w,searchSuggestion:R,searchOriginal:O,threshold:l,disabled:_,googleStoreList:e,productLimit:p,eventsLimit:m,storesSimilar:b,showStoresRecommended:t,handleEventViewGoogleShopping:f,isShoppingTab:v,googleStoreBlacklist:h,enabledFallback:E,couponTagList:null!=u&&u.enabled&&null!=u&&u.coupons?u.coupons:[]};return xa("emit")("productSimilars",n,xa("pageName")),!0}}return!1}async function ka(e){await xa("waitForRootWrapperElement")();const t={disabled:!0,daysLeft:e};return xa("emit")("productSimilars",t,xa("pageName")),!1}const $a=async()=>{if(!xa("hasMinimumScreenWidth"))return!1;if(!xa("langAllowList").includes(xa("lang")))return!1;const e=await xa("getGoogleToastRemainingDisabledDays")();return 0===e?xa("start")():xa("userDisabled")(e)},Aa=async()=>new Promise((e=>{xa("db").getSetting("google-toast-disabled").then((async t=>{if(!t)return e(0);const n=xa("dateDiffIndays")(xa("today"),t);return e(n>0?n:0)}))}));function Da(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var ja=null;function Ga(){if(null===ja){let e=Da();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),ja=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return ja}function Na(){let e=Da();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Pa(){let e=Ga(),t=Na(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=Da();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Ba="__INTENTIONAL_UNDEFINED__";let Ua={};function xa(e){let t=Pa();if(void 0===t[e])return function(e){switch(e){case"StoreHelper":return ma;case"MINIMUM_SCREEN_WIDTH":return Ea;case"getPrice":return Ta;case"getSimilarProductsConfig":return E;case"pageName":return La;case"getFeatureConfig":return dt;case"getSponsorsDataFromElement":return va;case"getUrlFromGoogleQueryParams":return Sa;case"storeHelper":return ba;case"waitForRootWrapperElement":return aa;case"origin":return Ia;case"emit":return p;case"hasMinimumScreenWidth":return ya;case"langAllowList":return Ra;case"lang":return wa;case"getGoogleToastRemainingDisabledDays":return Aa;case"start":return Ca;case"userDisabled":return ka;case"db":return r;case"dateDiffIndays":return R;case"today":return Oa}return}(e);var n=t[e];return n===Ba?void 0:n}function Ma(e,t){let n=Pa();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Wa(e)}))}):(n[e]=void 0===t?Ba:t,function(){Wa(e)})}function Wa(e){let t=Pa();delete t[e],0==Object.keys(t).length&&delete Na()[Ga]}function Ha(e){let t=Pa();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(Ua,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",xa),e("__GetDependency__",xa),e("__Rewire__",Ma),e("__set__",Ma),e("__reset__",Wa),e("__ResetDependency__",Wa),e("__with__",Ha)}();async function Fa(){const e=await chrome.runtime.sendMessage({action:"getGoogleSelectors"});if(!e)return;const t=document.body.querySelectorAll(e);return await no("handleStoreBars")(t)}async function Ya(e){const t=[];for(let r of e){var n;let e=r.querySelector("a[data-ved]"),a=null==e?void 0:e.href;const o=await no("checkWebSite")(a);if(!o)continue;if(null===(n=o.blacklist)||void 0===n?void 0:n.includes(e.host))continue;const i=await no("getStore")(o.slug);if(!i)continue;if(await no("isFeatureDisabledInStore")("store-bar",o.slug))continue;const s=await no("isStoreInDenylist")("store-bar",o.slug);i.isThisStoreInDenyList=s,t.push(i),no("createStoreBarElement")(r,i)}return t}function qa(e,t){const{slug:n,name:r,numberOfCoupons:a,cashback:o,isThisStoreInDenyList:i}=t;if(a||o){const t=document.createElement("cuponomia-store-bar"),s=o||{};t.setAttribute("slug",n),t.setAttribute("name",r),t.setAttribute("haslink",i),t.setAttribute("coupons",a||0),t.setAttribute("cashback",JSON.stringify(s)),e&&e.append(t)}}async function Xa(){if(!await no("isFeatureEnabled")("store-bar"))return;if(document.querySelector("cuponomia-store-bar"))return;const e=await no("scraping")();return no("listenEvents")(),e}function Va(){window.addEventListener("message",(e=>{"event"==e.data.message&&chrome.runtime.sendMessage({action:"lookerSendEvent",data:{evt:"STORE_BAR",event_time_date:no("createFormattedDate")(),action:e.data.action,slug:e.data.slug}})}))}function za(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var Ka=null;function Ja(){if(null===Ka){let e=za();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),Ka=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return Ka}function Qa(){let e=za();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Za(){let e=Ja(),t=Qa(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=za();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var eo="__INTENTIONAL_UNDEFINED__";let to={};function no(e){let t=Za();if(void 0===t[e])return function(e){switch(e){case"handleStoreBars":return Ya;case"checkWebSite":return v;case"getStore":return w;case"isFeatureDisabledInStore":return I;case"isStoreInDenylist":return L;case"createStoreBarElement":return qa;case"isFeatureEnabled":return O;case"scraping":return Fa;case"listenEvents":return Va;case"createFormattedDate":return H}return}(e);var n=t[e];return n===eo?void 0:n}function ro(e,t){let n=Za();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){ao(e)}))}):(n[e]=void 0===t?eo:t,function(){ao(e)})}function ao(e){let t=Za();delete t[e],0==Object.keys(t).length&&delete Qa()[Ja]}function oo(e){let t=Za();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(to,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",no),e("__GetDependency__",no),e("__Rewire__",ro),e("__set__",ro),e("__reset__",ao),e("__ResetDependency__",ao),e("__with__",oo)}();async function io(){var e;const t=null===(e=document.querySelector("#APjFqb"))||void 0===e?void 0:e.value,n=document.getElementById("tvcap");if(document.querySelector("cuponomia-smart-banner")||!t||!n)return;const r=document.createElement("cuponomia-smart-banner"),{stores:a,matchKeyword:o}=await bo("getRelatedStores")(t),i=await bo("eventHelper").getMastersessionID();o&&a&&0!==(null==a?void 0:a.length)&&(r.setAttribute("data-stores",JSON.stringify(a)),r.setAttribute("data-emsid",i),n.prepend(r))}function so(e){return new Promise((t=>{chrome.runtime.sendMessage({action:"getRelatedStores",data:{keyword:e}},(e=>t(e)))}))}function co(){window.addEventListener("message",(e=>{"gaSendEvent"==e.data.message&&chrome.runtime.sendMessage({action:"gaSendEvent",data:{category:e.data.category,action:e.data.action,label:e.data.label,nonInteraction:e.data.nonInteraction}}),"eventSmartBanner"==e.data.message&&chrome.runtime.sendMessage({action:"lookerSendEvent",data:{evt:"SMART_BANNER",event_time_date:bo("createFormattedDate")(),action:e.data.action,slug:e.data.slug,label:e.data.label}})}))}async function uo(){await bo("isFeatureDisabled")("smart-banner")||(bo("scraping")(),bo("listenEvents")())}function lo(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var _o=null;function fo(){if(null===_o){let e=lo();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),_o=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return _o}function ho(){let e=lo();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function go(){let e=fo(),t=ho(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=lo();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var po="__INTENTIONAL_UNDEFINED__";let mo={};function bo(e){let t=go();if(void 0===t[e])return function(e){switch(e){case"getRelatedStores":return so;case"eventHelper":return $n;case"createFormattedDate":return H;case"isFeatureDisabled":return m;case"scraping":return io;case"listenEvents":return co}return}(e);var n=t[e];return n===po?void 0:n}function Eo(e,t){let n=go();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){yo(e)}))}):(n[e]=void 0===t?po:t,function(){yo(e)})}function yo(e){let t=go();delete t[e],0==Object.keys(t).length&&delete ho()[fo]}function vo(e){let t=go();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(mo,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",bo),e("__GetDependency__",bo),e("__Rewire__",Eo),e("__set__",Eo),e("__reset__",yo),e("__ResetDependency__",yo),e("__with__",vo)}();const wo="google";async function Ro(e){var t;const{selectors:n,blacklist:r}=await jo("getFeatureConfig")("partnerStores");if(document.querySelectorAll(n.productList).length>0)return;const a=(null===(t=document.querySelector(n.search))||void 0===t?void 0:t.value)??null;if(!a)return;await jo("waitForRootWrapperElement")();const o={origin:jo("origin"),search:a,blacklist:r,variation:"store_match",store:e};await jo("generalHelper").waitDelay(2e3),jo("emit")("partnerStores",o,jo("pageName"))}async function Oo(e){var t;const{selectors:n,blacklist:r}=await jo("getFeatureConfig")("partnerStores"),a=(null===(t=document.querySelector(n.search))||void 0===t?void 0:t.value)??null,o={origin:jo("origin"),blacklist:r,stores:e,variation:"store_bar_logic",search:a};await jo("generalHelper").waitDelay(2e3),jo("emit")("partnerStores",o,jo("pageName"))}const Io=async e=>{if(!await jo("isFeatureEnabled")("partnerStores"))return;const t=document.querySelector("html").getAttribute("lang");["pt-PT","pt-BR","en-BR","en"].includes(t)&&jo("startExactMatch")(e)},Lo=async e=>{await jo("isFeatureEnabled")("partnerStores")&&jo("start")(e)};function To(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}var So=null;function Co(){if(null===So){let e=To();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),So=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return So}function ko(){let e=To();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function $o(){let e=Co(),t=ko(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=To();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var Ao="__INTENTIONAL_UNDEFINED__";let Do={};function jo(e){let t=$o();if(void 0===t[e])return function(e){switch(e){case"getFeatureConfig":return T;case"waitForRootWrapperElement":return aa;case"origin":return"ge";case"generalHelper":return Tr;case"emit":return p;case"pageName":return wo;case"isFeatureEnabled":return O;case"startExactMatch":return Ro;case"start":return Oo}return}(e);var n=t[e];return n===Ao?void 0:n}function Go(e,t){let n=$o();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){No(e)}))}):(n[e]=void 0===t?Ao:t,function(){No(e)})}function No(e){let t=$o();delete t[e],0==Object.keys(t).length&&delete ko()[Co]}function Po(e){let t=$o();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(Do,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",jo),e("__GetDependency__",jo),e("__Rewire__",Go),e("__set__",Go),e("__reset__",No),e("__ResetDependency__",No),e("__with__",Po)}();const Bo=new(Jo("StoreHelper")),{storeHasValidCashback:Uo}=Jo("useCashback")(),xo=async()=>new Promise((e=>{Jo("userHelper").getUserPreferences().then((async t=>{const n={similarProducts:t.hasPreference("similar-products")};return e(n)}))})),Mo=()=>{Jo("loadJs")("google.js")},Wo=async e=>{let{slug:t}=e;return new Promise((e=>{chrome.runtime.sendMessage({action:"getStore",data:{slug:t}},(t=>{if(t&&t.store)return e(t.store);e(null)}))}))},Ho=async()=>{var e;const t=await Jo("initStoreBar")();Jo("loadGoogleFiles")();let n=!1;if((await Jo("loadUserPreferences")()).similarProducts&&(n=await Jo("initSimilarProducts")()),n)return;const r=await Jo("getSimilarProductsConfig")("google");if(!r)return;const{selectors:a}=r,o=(null===(e=document.querySelector(a.search))||void 0===e?void 0:e.value)??"";if(!o)return;const i=await Jo("storeHelper").getStoreByName(o);if(!i)return t.length>0?Jo("initPartnerStores")(t):void 0;const s=await Jo("getStoreData")({slug:i.slug});if(!Jo("storeHasValidCashback")(s))return Jo("initSmartBanner")();await Jo("InitExactMatchPartnerStores")(s)};function Fo(){try{if(n.g)return n.g}catch(e){try{if(window)return window}catch(e){return this}}}Jo("initGoogleFeatures")().then((()=>{chrome.runtime.sendMessage({action:"injectContentScripts",data:{page:"google"}})}));var Yo=null;function qo(){if(null===Yo){let e=Fo();e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__||(e.__$$GLOBAL_REWIRE_NEXT_MODULE_ID__=0),Yo=__$$GLOBAL_REWIRE_NEXT_MODULE_ID__++}return Yo}function Xo(){let e=Fo();return e.__$$GLOBAL_REWIRE_REGISTRY__||(e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)),e.__$$GLOBAL_REWIRE_REGISTRY__}function Vo(){let e=qo(),t=Xo(),n=t[e];return n||(t[e]=Object.create(null),n=t[e]),n}!function(){let e=Fo();e.__rewire_reset_all__||(e.__rewire_reset_all__=function(){e.__$$GLOBAL_REWIRE_REGISTRY__=Object.create(null)})}();var zo="__INTENTIONAL_UNDEFINED__";let Ko={};function Jo(e){let t=Vo();if(void 0===t[e])return function(e){switch(e){case"StoreHelper":return ma;case"useCashback":return Je;case"userHelper":return mn;case"loadJs":return y;case"initStoreBar":return Xa;case"loadGoogleFiles":return Mo;case"loadUserPreferences":return xo;case"initSimilarProducts":return $a;case"getSimilarProductsConfig":return E;case"storeHelper":return Bo;case"initPartnerStores":return Lo;case"getStoreData":return Wo;case"storeHasValidCashback":return Uo;case"initSmartBanner":return uo;case"InitExactMatchPartnerStores":return Io;case"initGoogleFeatures":return Ho}return}(e);var n=t[e];return n===zo?void 0:n}function Qo(e,t){let n=Vo();return"object"==typeof e?(Object.keys(e).forEach((function(t){n[t]=e[t]})),function(){Object.keys(e).forEach((function(t){Zo(e)}))}):(n[e]=void 0===t?zo:t,function(){Zo(e)})}function Zo(e){let t=Vo();delete t[e],0==Object.keys(t).length&&delete Xo()[qo]}function ei(e){let t=Vo();var n=Object.keys(e),r={};function a(){n.forEach((function(e){t[e]=r[e]}))}return function(o){n.forEach((function(n){r[n]=t[n],t[n]=e[n]}));let i=o();return i&&"function"==typeof i.then?i.then(a).catch(a):a(),i}}!function(){function e(e,t){Object.defineProperty(Ko,e,{value:t,enumerable:!1,configurable:!0})}e("__get__",Jo),e("__GetDependency__",Jo),e("__Rewire__",Qo),e("__set__",Qo),e("__reset__",Zo),e("__ResetDependency__",Zo),e("__with__",ei)}()})()})();